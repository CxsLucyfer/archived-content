---
title: 字节码
slug: Mozilla/Projects/SpiderMonkey/Internals/Bytecodes
tags:
  - SpiderMonkey
translation_of: Mozilla/Projects/SpiderMonkey/Internals/Bytecodes
---
<div><section class="Quick_links" id="Quick_Links">
 <ol>
  <li><a href="/zh-CN/docs/Mozilla/Projects/SpiderMonkey"><strong><em>SpiderMonkey</em></strong></a></li>

  <li><strong>References:</strong></li>
  <li class="toggle">
    <details>
        <summary>JSAPI reference</summary>
        <ol><li><a href="/zh-CN/docs/Mozilla/Projects/SpiderMonkey/JSAPI_reference/BOOLEAN_TO_JSVAL"><code>BOOLEAN_TO_JSVAL</code></a> <a href="/zh-CN/docs/Mozilla/Projects/SpiderMonkey/JSAPI_reference/BOOLEAN_TO_JSVAL$translate" style="opacity: 0.5;">[我来译!]</a></li><li><a href="/zh-CN/docs/Mozilla/Projects/SpiderMonkey/JSAPI_reference/JS_DefineConstDoubles"><code>JS DefineConstDoubles</code></a> <a href="/zh-CN/docs/Mozilla/Projects/SpiderMonkey/JSAPI_reference/JS_DefineConstDoubles$translate" style="opacity: 0.5;">[我来译!]</a></li><li><a href="/zh-CN/docs/Mozilla/Projects/SpiderMonkey/JSAPI_reference/JS::Call"><code>JS::Call</code></a> <a href="/zh-CN/docs/Mozilla/Projects/SpiderMonkey/JSAPI_reference/JS::Call$translate" style="opacity: 0.5;">[我来译!]</a></li><li><a href="/zh-CN/docs/Mozilla/Projects/SpiderMonkey/JSAPI_reference/JS::OrdinaryToPrimitive"><code>JS::OrdinaryToPrimitive</code></a> <a href="/zh-CN/docs/Mozilla/Projects/SpiderMonkey/JSAPI_reference/JS::OrdinaryToPrimitive$translate" style="opacity: 0.5;">[我来译!]</a></li><li><a href="/zh-CN/docs/Mozilla/Projects/SpiderMonkey/JSAPI_reference/JSClass"><code>JSClass</code></a> <a href="/zh-CN/docs/Mozilla/Projects/SpiderMonkey/JSAPI_reference/JSClass$translate" style="opacity: 0.5;">[我来译!]</a></li><li><a href="/zh-CN/docs/Mozilla/Projects/SpiderMonkey/JSAPI_reference/JSConstDoubleSpec"><code>JSConstDoubleSpec</code></a> <a href="/zh-CN/docs/Mozilla/Projects/SpiderMonkey/JSAPI_reference/JSConstDoubleSpec$translate" style="opacity: 0.5;">[我来译!]</a></li><li><a href="/zh-CN/docs/Mozilla/Projects/SpiderMonkey/JSAPI_reference/JSErrorReport"><code>JSErrorReport</code></a> <a href="/zh-CN/docs/Mozilla/Projects/SpiderMonkey/JSAPI_reference/JSErrorReport$translate" style="opacity: 0.5;">[我来译!]</a></li><li><a href="/zh-CN/docs/Mozilla/Projects/SpiderMonkey/JSAPI_reference/JSPropertyDescriptor"><code>JSPropertyDescriptor</code></a> <a href="/zh-CN/docs/Mozilla/Projects/SpiderMonkey/JSAPI_reference/JSPropertyDescriptor$translate" style="opacity: 0.5;">[我来译!]</a></li><li><a href="/zh-CN/docs/Mozilla/Projects/SpiderMonkey/JSAPI_reference/JSRuntime"><code>JSRuntime</code></a> <a href="/zh-CN/docs/Mozilla/Projects/SpiderMonkey/JSAPI_reference/JSRuntime$translate" style="opacity: 0.5;">[我来译!]</a></li><li><a href="/zh-CN/docs/Mozilla/Projects/SpiderMonkey/JSAPI_reference/JS_NewRuntime"><code>JS_NewRuntime</code></a> <a href="/zh-CN/docs/Mozilla/Projects/SpiderMonkey/JSAPI_reference/JS_NewRuntime$translate" style="opacity: 0.5;">[我来译!]</a></li><li><a href="/zh-CN/docs/Mozilla/Projects/SpiderMonkey/JSAPI_reference/JS_EvaluateScript"><code>SpiderMonkey/JSAPI_参考/JS_EvaluateScript</code></a> <a href="/zh-CN/docs/Mozilla/Projects/SpiderMonkey/JSAPI_reference/JS_EvaluateScript$translate" style="opacity: 0.5;">[我来译!]</a></li><li><a href="/zh-CN/docs/Mozilla/Projects/SpiderMonkey/JSAPI_reference/JS_GetVersion"><code>SpiderMonkey/JSAPI_参考/JS_GetVersion</code></a> <a href="/zh-CN/docs/Mozilla/Projects/SpiderMonkey/JSAPI_reference/JS_GetVersion$translate" style="opacity: 0.5;">[我来译!]</a></li><li><a href="/zh-CN/docs/Mozilla/Projects/SpiderMonkey/JSAPI_reference/JS_SetErrorReporter"><code>SpiderMonkey/JSAPI_参考/JS_SetErrorReporter</code></a> <a href="/zh-CN/docs/Mozilla/Projects/SpiderMonkey/JSAPI_reference/JS_SetErrorReporter$translate" style="opacity: 0.5;">[我来译!]</a></li><li><a href="/zh-CN/docs/Mozilla/Projects/SpiderMonkey/JSAPI_reference/JS_ValueToString"><code>SpiderMonkey/JSAPI_参考/JS_ValueToString</code></a> <a href="/zh-CN/docs/Mozilla/Projects/SpiderMonkey/JSAPI_reference/JS_ValueToString$translate" style="opacity: 0.5;">[我来译!]</a></li></ol>
    </details>
  </li>
  <li class="toggle">
    <details>
      <summary>Debugger-API</summary>

    </details>
  </li>
  <li><strong>Guides:</strong></li>
  <li class="toggle">
    <details>
      <summary>General</summary>
      <ol>
        <li><a href="/zh-CN/docs/Mozilla/Projects/SpiderMonkey/Build_Documentation">Build documentation</a></li>
        <li><a href="/zh-CN/docs/Mozilla/Projects/SpiderMonkey/Introduction_to_the_JavaScript_shell">Introduction to the JavaScript shell</a></li>
        <li><a href="/zh-CN/docs/Mozilla/Projects/SpiderMonkey/JSAPI_User_Guide">JSAPI user guide</a></li>
        <li><a href="/zh-CN/docs/Mozilla/Projects/SpiderMonkey/JSAPI_Cookbook">JSAPI cookbook</a></li>
        <li><a href="/zh-CN/docs/Mozilla/Projects/SpiderMonkey/How_to_embed_the_JavaScript_engine">How to embed the JavaScript engine</a></li>
        <li><a href="/zh-CN/docs/Mozilla/Projects/SpiderMonkey/GC_Rooting_Guide">GC Rooting Guide</a></li>
      </ol>
    </details>
  </li>
  <li class="toggle">
    <details open>
      <summary>SpiderMonkey internals</summary>
      <ol><li><a href="/zh-CN/docs/Mozilla/Projects/SpiderMonkey/Internals/Functions">Functions</a></li><li><a href="/zh-CN/docs/SpiderMonkey_Garbage_Collection_Tips">SpiderMonkey Garbage Collection Tips</a></li><li><a href="/zh-CN/docs/Mozilla/Projects/SpiderMonkey/Internals/Bytecodes">字节码</a></li></ol>
    </details>
  </li>

  <li><strong>Contributing to SpiderMonkey:</strong></li>
  <li class="toggle">
    <details>
      <summary>Getting started</summary>
      <ol>
        <li><a href="https://wiki.mozilla.org/JavaScript:New_to_SpiderMonkey">New to SpiderMonkey</a></li>
        <li><a href="/zh-CN/docs/Mozilla/Projects/SpiderMonkey/Setting_up_CDT_to_work_on_SpiderMonkey">Setting up CDT to work on SpiderMonkey</a></li>
        <li><a href="/zh-CN/docs/Mozilla/Projects/SpiderMonkey/Hacking_Tips">Hacking tips</a></li>
      </ol>
    </details>
  </li>
  <li class="toggle">
    <details>
      <summary>Tests</summary>
      <ol>
        <li><a href="/zh-CN/docs/Mozilla/Projects/SpiderMonkey/Running_Automated_JavaScript_Tests">Running Automated JavaScript Tests</a></li>
        <li><a href="/zh-CN/docs/Mozilla/Projects/SpiderMonkey/Creating_JavaScript_tests">Creating JavaScript tests</a></li>
        <li><a href="/zh-CN/docs/Mozilla/Projects/SpiderMonkey/Running_Parsemark">Running Parsemark</a></li>
       </ol>
    </details>
  </li>

  <li><strong>Releases:</strong></li>
  <li class="toggle">
    <details>
      <summary>Release notes</summary>

    </details>
  </li>
  <li><strong><a href="/zh-CN/docs/MDN">Documentation:</a></strong></li>
  <li class="toggle">
    <details>
      <summary>Useful lists</summary>
      <ol>
        <li><a href="/zh-CN/docs/Mozilla/Projects/SpiderMonkey/Index">All pages index</a></li>
        <li><a href="/zh-CN/docs/tag/SpiderMonkey">Pages tagged &quot;SpiderMonkey&quot;</a></li>
      </ol>
    </details>
  </li>
  <li class="toggle">
    <details>
      <summary>Contribute</summary>
      <ol>
        <li><a href="/zh-CN/docs/MDN/Doc_status/SpiderMonkey">SpiderMonkey doc status</a></li>
        <li><a href="/zh-CN/docs/MDN">The MDN project</a></li>
      </ol>
    </details>
  </li>
 </ol>
</section></div>

<h2 id="背景知识">背景知识</h2>

<p>SpiderMonkey字节码是JavaScript引擎使用的标准代码表示形式。JavaScript前端根据源文本构建AST，然后根据JSScript数据结构的一部分从AST生成基于堆栈的字节码。字节码可以引用原子和对象（通常通过数组索引），这些原子和对象也包含在JSScript数据结构中。</p>

<p>在引擎内，所有字节码都在堆栈帧内执行。堆栈帧与全局（顶级）代码和<code>eval</code>代码相关联。堆栈上的框架为几个不同类别的JavaScript值（标记值格式）留出空间。单个JavaScript值空间称为“插槽”，类别为：</p>

<ul>
 <li>参数槽：保存传递给当前框架的实际参数。</li>
 <li>本地插槽：保存当前代码中使用的本地变量。</li>
 <li>表达式槽：保存在堆栈上计算表达式所需的临时空间。例如，<code>(a + b) + c</code>会压入a，然后压入b，再压入+，然后压入c，再压入+，依此类推。这需要最多两个表达槽的深度。</li>
</ul>

<p>还有一些保留给专用功能的插槽，用于处理<code>this</code>和<code>callee</code>返回值。.</p>

<p>总有一个“堆栈顶部”（TOS），它对应于推入表达式堆栈的最新值。所有字节码都根据该位置隐式运行。</p>

<h2 id="字节码列表">字节码列表</h2>

<p>所有操作码都用<code> [-popcount, +pushcount] </code>标注，以表示整个执行的堆栈效果。</p>

<p>字节码列表已移至 <a href="/en-US/docs/Mozilla/Projects/SpiderMonkey/Internals/Bytecode" title="SpiderMonkey Internals: Bytecode Descriptions">SpiderMonkey Internals: Bytecode Descriptions</a> 页面。</p>
