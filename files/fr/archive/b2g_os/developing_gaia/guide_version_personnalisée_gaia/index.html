---
title: Guide pour créer une version personnalisée de Gaia
slug: Archive/B2G_OS/Developing_Gaia/Guide_version_personnalisée_Gaia
tags:
  - Customization
  - Firefox OS
  - Gaia
  - Marketplace
  - build
translation_of: Archive/B2G_OS/Developing_Gaia/Market_customizations_guide
---
<div class="summary">
<p>Il est possible de créer une version personnalisée (par exemple, choisir les applications intégrées dans la version) sans modifier le cœur du dépôt de Gaia. Vous pouvez ajouter vos éléments de personnalisation dans des dossiers distincts ou bien utiliser les répertoires existants dans le code originale. Les options de construction (<em>build</em>) permettent de spécifier les éléments à personnaliser. Cet article expliquera en détail comment créer et utiliser ces éléments de personnalisation.</p>
</div>

<h2 id="Aperçu">Aperçu</h2>

<p>Depuis la version 1.0.1, Firefox OS utilise le même mécanisme pour apporter les personnalisations. Toutes les fonctionnalités illustrées dans cet article fonctionnent pour Firefox OS 1.0.1 sauf mention contraire.<br>
 <br>
 Une version entièrement personnalisée de <a href="https://github.com/mozilla-b2g/gaia/tree/master/customization">Gaia </a>fait partie du dépôt Gaia : vous pouvez explorer les différents aspects de personnalisation sur cette version et/ou suivre cet article.</p>

<div class="note notecard">
<p><strong>Note </strong>: Merci d&apos;envoyer une <em>pull request</em> sur le dépôt Github de Gaia pour toute suggestion permettant d&apos;améliorer cet exemple, ou si vous trouvez des éléments de cet article qui ne sont pas exploités dans ce code.</p>
</div>

<p>Voici l&apos;arborescence de l&apos;exemple de personnalisation :</p>

<pre>  customize-sample
  ├── power
  │   ├── carrier_power_on.png
  │   └── carrier_power_off.png
  ├── ringtones
  │   ├── list.json
  │   └── ringer_dream_theme.ogg
  ├── wallpapers
  │   ├── customize.png
  │   └── list.json
  ├── browser.json
  ├── calendar.json
  ├── contacts.json
  ├── costcontrol.json
  ├── device-features.json
  ├── eu-roaming.json
  ├── homescreens.json
  ├── network.json
  ├── settings.json
  ├── sms-blacklist.json
  ├── support.json
  ├── wapuaprof.json
  └── apps.list</pre>

<div class="note notecard">
<p><strong>Note </strong>: Chacun des fichiers est optionnel. Si vous ne fournissez pas un de ces fichiers, le fichier par défaut sera pris en compte.</p>
</div>

<p>Chacune de ces personnalisations sera discutée dans la suite. Le paragraphe suivant, quant à lui, explique comment appliquer ces éléments de personnalisation à Gaia.</p>

<h2 id="Les_étapes_pour_appliquer_la_personnalisation">Les étapes pour appliquer la personnalisation</h2>

<p>Pour appliquer l&apos;exemple de personnalisation à Gaia, il faut :</p>

<ol>
 <li>Clôner le dépôt de Gaia depuis <a href="https://github.com/mozilla-b2g/gaia">https://github.com/mozilla-b2g/gaia</a>.</li>
 <li>Copier le répertoire <code>gaia/customization/</code> dans un autre répertoire pour y apporter vos propres adaptations ou bien éditer directement le contenu du répertoire <code>gaia/customization/</code>. Le chemin du répertoire en question sera évoqué par  <code>&lt;DISTRIBUTION_PATH&gt;</code> dans la suite. À chaque exemple, assurez-vous de bien remplacer la variable dans les commandes.</li>
 <li>Effectuez les changements que vous souhaitez.</li>
 <li>Connectez un appareil Firefox OS à votre ordinateur par USB, vérifiez que celui-ci est bien reconnu par <a href="/Firefox_OS/Debugging/Installing_ADB">ADB</a>.</li>
 <li>Construisez Gaia en spécifiant l&apos;emplacement du répertoire de personnalisation en utilisant la variable d&apos;environnement <code>GAIA_DISTRIBUTION_DIR</code> avec :
  <pre class="brush: bash">make production GAIA_DISTRIBUTION_DIR=&lt;DISTRIBUTION_PATH&gt;</pre>
 </li>
 <li>Vous devriez désormais disposez d&apos;une version personnalisée de Gaia sur votre appareil Firefox OS.</li>
</ol>

<p>Si vous copiez le contenu du répertoire de personnalisation dans <code>gaia/distribution/</code>, vous pouvez lancer la commande <code>make</code> sans la variable d&apos;environnement :</p>

<pre class="brush: bash">make production</pre>

<div class="note notecard">
<p><strong>Note </strong>: Certaines personnalisations ont lieu lors de l&apos;exécution des scripts de construction. Voir <a href="/en-US/Firefox_OS/Developing_Gaia/make_options_reference">la référence des options de <code>make</code></a> pour les éléments de personnalisation liés aux scripts de construction.</p>
</div>

<div class="note notecard">
<p><strong>Note </strong>: Les éléments de personnalisation concernant la carte SIM sont inclus lors de la construction. Par contre, ils sont appliqués lors de la phase de première utilisation (FTU pour First Time Usage en anglais).</p>
</div>

<h2 id="Les_personnalisations_appliquées_lors_de_la_construction">Les personnalisations appliquées lors de la construction</h2>

<p>Dans la suite du paragraphe, les différentes options de l&apos;exemple seront illustrées.</p>

<h3 id="power">power/</h3>

<p>Les animations (ou les images fixes) pour les écrans d&apos;allumage/extinction de l&apos;appareil sont à insérer ici. Les fichiers peuvent être des animations MP4 ou des images PNG.</p>

<p>Les noms de fichiers acceptés sont :</p>

<ul>
 <li><code>carrier_power_on.png</code></li>
 <li><code>carrier_power_on.mp4</code></li>
 <li><code>carrier_power_off.png</code></li>
 <li><code>carrier_power_off.mp4</code></li>
</ul>

<p>(<code>carrier_power_on.[png/mp4]</code> sera utilisé lors de l&apos;allumage, <code>carrier_power_off.[png/mp4]</code> sera utilisé lors de l&apos;extinction)</p>

<h3 id="ringtones">ringtones/</h3>

<p>Les sonneries personnalisées peuvent être placées ici. Le fichier <code>list.json</code> doit contenir les noms des fichiers des différentes sonneries, dans le format suivant :</p>

<pre class="brush: js">  {
    &quot;ringer_classic_courier.opus&quot;: &quot;&quot;,
    &quot;ringer_dream_theme.ogg&quot;: &quot;&quot;,
    &quot;ringer_loud_windchimes.opus&quot;: &quot;&quot;,
    &quot;ringer_bitbounce.opus&quot;: &quot;&quot;
  }</pre>

<p>Les sonneries personnalisées peuvent être choisies dans les réglages de Firefox OS via <em>Son &gt; Sonnerie</em>. La sonnerie par défaut doit être définie dans <code>settings.json</code>, avec une DataURI. Vous pouvez utiliser la commande <strong>datauri</strong> pour créer l&apos;URI qui est disponible via Node.js/npm:</p>

<ol>
 <li>Installer l&apos;utilitaire avec la commande <code><strong>npm install datauri -g</strong></code></li>
 <li>Convertir le fichier en DataURI avec <code><strong>datauri &lt;FILE&gt;</strong></code>.</li>
</ol>

<h3 id="wallpapers">wallpapers/</h3>

<p>Les fonds d&apos;écran par défaut (fichiers PNG) peuvent être placés dans ce dossier et lister dans le fichier <code>list.json</code>. Ils pourront être sélectionné dans les réglages de Firefox OS via <em>Affichage &gt; Fond d&apos;écran</em>.</p>

<p>Le fond d&apos;écran par défaut peut être défini dans le fichier <code>settings.json</code> grâce à la ligne suivante :</p>

<pre class="brush: js">&quot;wallpaper.image&quot;: &quot;emplacement de l&apos;image&quot;</pre>

<div class="note notecard">
<p><strong>Note </strong>: L&apos;image peut être définie grâce à un chemin de fichier ou grâce à une DataURI.</p>
</div>

<h3 id="browser.json">browser.json</h3>

<p>Ce fichier permet d&apos;ajouter des éléments personnalisés dans l&apos;application Navigateur (par exemple des marque-pages, des moteurs de recherche par défaut). Voir la section <a href="/en-US/Firefox_OS/Hacking_Firefox_OS/Market_customizations_guide#Browser_bookmarks_.26_default_search_engine">Marque-pages et moteur de recherche par défaut</a> pour plus d&apos;informations sur les informations à placer dans ce fichier.</p>

<h3 id="calendar.json">calendar.json</h3>

<p>Ce fichier permet d&apos;ajouter vos propres calendrier à l&apos;application Calendrier de Firefox OS. Pour cela, il sera nécessaire de définir vous identifiants Google OAuth. De plus, vous aurez besoin de configuer un accès à l&apos;API CalDav : pour générer la clé d&apos;API et le secret associé, vous aurez besoin de <a href="https://developers.google.com/google-apps/calendar/caldav/v2/guide#creating_your_client_id">créer votre identifiant client</a> (client au sens informatique). Pour cela, suivez les étapes suivantes :</p>

<ol>
 <li>Ouvrez la <a href="https://code.google.com/apis/console/b/0">console d&apos;API</a>.</li>
 <li>Créez un projet puis activez <em>Calendar CalDav API</em> dans <em>APIs &amp; auth &gt; APIs</em> (API et authentification &gt; API)</li>
 <li>Cliquez sur <em>Credentials</em> (Identifiants)</li>
 <li>Cliquez sur <em>Create new client ID</em> (Créer un nouvel identifiant de client)</li>
 <li>Définissez le champ <em>Application type</em> (Type d&apos;application) avec <em>Installed application</em> (application installée) et définir <em>Installed application type</em> avec <em>Other</em> (autre) puis cliquez sur <em>Create Client ID</em> (Créer un identifiant client). Vous devriez obtenir un identifiant et un secret de client.</li>
 <li>Ouvrez le fichier <code>calendar.json</code>, modifiez les valeurs <code>client_id</code> et <code>client_secret</code> avec celles que vous avez obtenues à l&apos;étape précédente. Sauvegardez puis fermez le fichier.</li>
</ol>

<div class="note notecard">
<p><strong>Note</strong> : L&apos;utilisation de l&apos;API est limitée à 1 000 000 (1 millions) de requêtes par jour.</p>
</div>

<h3 id="camera-config.json_(Tailles_d&apos;image_pour_la_galerie_et_l&apos;appareil_photo)">camera-config.json (Tailles d&apos;image pour la galerie et l&apos;appareil photo)</h3>

<pre class="brush: js">{
  &quot;maxImagePixelSize&quot;: 6000000,
  &quot;maxSnapshotPixelSize&quot;: 4000000,
  &quot;requiredEXIFPreviewSize&quot;: {
    &quot;width&quot;: 1200,
    &quot;height&quot;: 1222
  }
}
</pre>

<p><code>maxImagePixelSize</code> et <code>maxSnapshotPixelSize</code> correspondent aux tailles maximales, exprimées en pixels. Par défaut, ces paramètres sont fixés à 5 mega pixels (5x2<sup>20</sup> pixels 5MP).</p>

<p>Vous pouvez également définir les variables nécessaires pour définir la taille minimale de l&apos;aperçu EXIF qui sera utilisé lors de la prévisualisation plein écran en ajoutant la propriété <code>requiredEXIFPreviewSize</code>. Si vous ne définissez pas cette propriété, la prévisualisation EXIF ne sera faite que lorsqu&apos;elle sera assez grande pour remplir l&apos;écran (en largeur ou en hauteur) en paysage ou en portrait.</p>

<h3 id="contacts.json">contacts.json</h3>

<p>Les contacts listés dans ce fichier seront intégrés à la base de données des contacts du téléphone lors de la construction de Gaia.</p>

<p>Voici un exemple de fichier <code>contacts.json</code> :</p>

<pre class="brush: js">[
   {
     &quot;name&quot;: [&quot;Jean Biche&quot;],
     &quot;givenName&quot;: [&quot;Jean&quot;],
     &quot;familyName&quot;: [&quot;Biche&quot;],
     &quot;nickname&quot;: [&quot;Johnny&quot;],
     &quot;category&quot;: [&quot;Travail&quot;, &quot;Équipe bowling&quot;],
     &quot;email&quot;: [
       {
         &quot;type&quot;: [&quot;personal&quot;],
         &quot;value&quot;: &quot;jean.biche@exemple.org&quot;,
         &quot;pref&quot;: true
       },
       {
         &quot;type&quot;: [&quot;work&quot;],
         &quot;value&quot;: &quot;jbiche@société.com&quot;
       }
     ],
     &quot;adr&quot;: [
       {
         &quot;type&quot;: [&quot;personal&quot;],
         &quot;streetAddress&quot;: &quot;123 Foopy St.&quot;,
         &quot;locality&quot;: &quot;San Francisco&quot;,
         &quot;region&quot;: &quot;Downtown&quot;,
         &quot;postalCode&quot;: &quot;94030&quot;,
         &quot;countryName&quot;: &quot;US&quot;
       }
     ]
   },
   {
     &quot;name&quot;: [&quot;Operateur&quot;],
     &quot;email&quot;: [
       {
         &quot;type&quot;: [&quot;work&quot;],
         &quot;value&quot;: &quot;support@opérateurx.com&quot;
       }
     ],
     &quot;url&quot;: [
       {
         &quot;type&quot;: [&quot;work&quot;],
         &quot;value&quot;: &quot;https://www.opérateurx.com&quot;
       }
     ]
   }
 ]</pre>

<div class="note notecard">
<p><strong>Note </strong>: Voir la page sur <a href="/docs/Web/API/Contacts_API">l&apos;API Contacts</a> pour plus d&apos;informations sur la structure des objets contacts.</p>
</div>

<div class="note notecard">
<p><strong>Note</strong> : Pour des personnalisations propres à la carte SIM, lire la section <a href="#Marque-pages_et_moteur_de_recherche_par_défaut_du_navigateur">Marque-pages et moteur de recherche par défaut du navigateur</a>.</p>
</div>

<h3 id="device-features.json">device-features.json</h3>

<p>Ce fichier définit les capacités matérielles de l&apos;appareil. Par défaut, le fichier contient :</p>

<pre class="brush: js">{
  &quot;ambientLight&quot;: true,
  &quot;vibration&quot;: true,
  &quot;usbHotProtocolSwitch&quot;: false
}</pre>

<p>Pour le capteur de lumière et le vibreur, vous pouvez changer ces valeurs à <code>false</code> si vous souhaitez désactiver certaines fonctionnalités de l&apos;appareil.</p>

<h3 id="eu-roaming.json">eu-roaming.json</h3>

<p>Ce fichier contient la liste des opérateurs qui doivent respecter la législation européenne pour l&apos;itinérance des données, ainsi que les APN (<em>Access Point Name</em>) correspondants. Le fichier est composé de trois partie. La première <code>home</code>, contient les codes des opérateurs qui doivent respecter cette législation. La deuxième partie, <code>foreign</code>, contient les codes des opérateurs étrangers pour lesquels une notification devrait être activée lors de l&apos;itinérance des données est active dans ce pays. Enfin, la dernière partie contient le détail pour les APN par défaut dans l&apos;Union européenne. Par défaut, le contenu du fichier est :</p>

<pre class="brush: js">{
  &quot;home&quot;: null,
  &quot;foreign&quot;: null,
  &quot;defaultApns&quot;: []
}
</pre>

<p>Si vous souhaitez que le système d&apos;exploitation affiche une notification lors de l&apos;itinérance des données, le fichier ressemblera à celui présenté ci-dessous. Pour cet exemple, l&apos;utilisateur utilisant une carte SIM d&apos;un opérateur &quot;001, 01&quot; recevra une notification concernant l&apos;itinérance des données quand il utilisera le réseau de l&apos;opérateur dont le code est &quot;002, 02&quot; :</p>

<pre class="brush: js">{
  &quot;home&quot;: {
    &quot;001&quot;: {
      &quot;01&quot;: true
    }
  },
  &quot;foreign&quot;: {
    &quot;002&quot;: {
      &quot;02&quot;: true
    }
  },
  &quot;defaultApns&quot;: [{
    &quot;apn&quot;: &quot;eu.apn&quot;,
    &quot;types&quot;: [&quot;default&quot;]
  }]
}
</pre>

<div class="note notecard">
<p><strong>Note</strong> : Tous les paramètres des APN listés dans <code>defaultApns</code> apparaîtront également via l&apos;application des Paramètres.</p>
</div>

<h3 id="homescreens.json">homescreens.json</h3>

<p><a href="https://github.com/mozilla-b2g/gaia/blob/master/customization/homescreens.json">homescreens.json</a> définit les applications à afficher sur la partie principale de l&apos;écran d&apos;accueil et sur les autres pages de l&apos;écran d&apos;accueil, ainsi que l&apos;ordre dans lequel elles sont affichées. Par défaut, le fichier contient :</p>

<pre class="brush: js">{&quot;homescreens&quot;: [
   [
     [&quot;apps&quot;, &quot;communications&quot;, &quot;dialer&quot;],
     [&quot;apps&quot;, &quot;sms&quot;],
     [&quot;apps&quot;, &quot;browser&quot;],
     [&quot;apps&quot;, &quot;camera&quot;]
   ]
 ]}</pre>

<p>Avec ces informations, les quatres applications décrites seront affichées sur l&apos;écran principal de l&apos;écran d&apos;accueil. Si on ajoute un autre tableau, les applications contenues apparaîtront sur la première page de l&apos;écran d&apos;accueil, l&apos;ensemble suivant apparaîtra sur la deuxième page et ainsi de suite.</p>

<pre class="brush: js">{&quot;homescreens&quot;: [
   [ // Écran principal pour l&apos;écran d&apos;accueil
     [&quot;apps&quot;, &quot;communications&quot;, &quot;dialer&quot;],
     [&quot;apps&quot;, &quot;sms&quot;],
     [&quot;apps&quot;, &quot;browser&quot;],
     [&quot;apps&quot;, &quot;camera&quot;]
   ],
   [ // Page 1 de l&apos;écran d&apos;accueil
     [&quot;apps&quot;, &quot;email&quot;],
     [&quot;apps&quot;, &quot;settings&quot;],
     [&quot;apps&quot;, &quot;clock&quot;],
     [&quot;apps&quot;, &quot;calendar&quot;]
   ],
   [ // Page 1 de l&apos;écran d&apos;accueil
     [&quot;external-apps&quot;, &quot;appPerso1&quot;],
     [&quot;external-apps&quot;, &quot;appPerso2&quot;],
     [&quot;external-apps&quot;, &quot;appPerso3&quot;],
     [&quot;external-apps&quot;, &quot;appPerso4&quot;]
   ]
 ]}</pre>

<p>Le premier élément de chaque sous-tableau correspond au nom du répertoire de l&apos;application, le second correspond au nom de l&apos;application et de son répertoire dédié.</p>

<h4 id="Collections">Collections</h4>

<div class="note notecard">
<p><strong>Note</strong> : Avec Firefox 2.0, le répertoire <code>collections</code> a été déplacé de l&apos;application <code>homescreen</code> vers l&apos;application <code>collections</code>. Certains champs du fichier manifeste ont également été modifiés (voir le fichier de manifeste pour la collection <a href="https://github.com/mozilla-b2g/gaia/blob/master/apps/collection/collections/funny/manifest.collection">funny</a> par exemple) : <code>provider_id</code> a été modifié en  <code>categoryId</code>, et <code>apps</code> a été modifié en <code>pinned</code>.</p>
</div>

<p>Les collections sont des groupes d&apos;applications avec leur propre icône qui apparaît sur l&apos;écran d&apos;accueil. Lorsque l&apos;utilisateur touche l&apos;icône, un nouvel écran apparaît et présente l&apos;ensemble des icônes pour les applications contenues dans le groupe. Vous pouvez regarder <a href="https://github.com/mozilla-b2g/gaia/tree/master/apps/collection/collections">le contenu du répertoire collections</a> pour voir les collections disponibles par défaut :</p>

<ul>
 <li><code>funny </code>: découvrez les dernières applications insolites</li>
 <li><code>games</code> : jouez à des jeux en ligne</li>
 <li><code>local </code>: ce qui se passe près de vous</li>
 <li><code>music</code> : écoutez votre musique préférée avec ces applications</li>
 <li><code>news</code> : restez à jour en suivant les actualités</li>
 <li><code>shopping</code> : les modes de shopping</li>
 <li><code>showbiz</code> : découvrez des applications de divertissement</li>
 <li><code>social </code>: gardez à portée vos réseaux sociaux</li>
 <li><code>sports</code> : les meilleurs appliactions sur le sport</li>
 <li><code>tv</code> : les applications liées aux medias</li>
</ul>

<p>Dans chacun de ces répertoires, vous trouverez les icônes pour les différentes résolutions ainsi qu&apos;un fichier de manifeste qui définit des méta-données sur la collection comme son nom, son rôle, ainsi que l&apos;emplacement de ces icônes.</p>

<div class="note notecard">
<p><strong>Note </strong>: Des collections supplémentaires sont disponibles sur le serveur E.me (19 collections au total, incluant les 10 collections présentées ci-dessus). Vous pouvez voir ces collections en maintenant une pression sur l&apos;écran d&apos;accueil et en choisissant l&apos;option &quot;Ajouter des collections intelligentes&quot;.</p>
</div>

<p>Dans le fichier <a href="https://github.com/mozilla-b2g/gaia/blob/master/customization/homescreens.json"><code>homescreens.json</code></a>, vous pouvez choisir les collections que vous souhaitez charger, les pages sur lesquelles elles doivent apparaître ainsi que l&apos;ordre de leur disposition. Par exemple, si on souhaite faire apparaître les collections <code>shopping</code>, <code>social</code>, <code>sports</code> et <code>tv</code>, on pourra avoir le fichier suivant :</p>

<pre class="brush: js">{&quot;homescreens&quot;: [
   [
     [&quot;apps/collection/collections&quot;, &quot;shopping&quot;],
     [&quot;apps/collection/collections&quot;, &quot;social&quot;],
     [&quot;apps/collection/collections&quot;, &quot;sports&quot;],
     [&quot;apps/collection/collections&quot;, &quot;tv&quot;]
   ], [
     [&quot;apps&quot;, &quot;communications&quot;, &quot;dialer&quot;],
     [&quot;apps&quot;, &quot;sms&quot;],
     [&quot;apps&quot;, &quot;browser&quot;],
     [&quot;apps&quot;, &quot;camera&quot;]
   ]
 ]}</pre>

<p>Chaque tableau de plus haut niveau fait référence à une des pages de l&apos;écran d&apos;accueil. Pour cet exemple, les collections apparaîtront sur la page principale (<em>dock</em>) de l&apos;écran d&apos;accueil et les applications individuelles apparaîtront sur la première page de l&apos;écran d&apos;accueil.</p>

<div class="note notecard">
<p><strong>Note </strong>: Par défaut, quatre collections sont utilisées pour la première page de l&apos;écran d&apos;accueil de Gaia : <em>social</em>, <em>games</em>, <em>music</em> et <em>entertainment</em>.</p>
</div>

<div class="note notecard">
<p><strong>Note </strong>: Les noms des collections sont écrits en minuscules.</p>
</div>

<h5 id="Le_contenu_des_collections">Le contenu des collections</h5>

<p>Les collections sont composées de deux types d&apos;application.<br>
 <br>
 <strong>Les applications locales</strong> sont définies lors de la construction grâce à une fichier de manifeste situé sous <code>/apps/collection/collections/&lt;nomDeLaCollection&gt;/manifest.collection</code>. Les applications locales contenues dans chaque collection sont définies dans le fichier de manifeste. La collection social (qui contient les applications pour le téléphone, les sms, les contacts et les e-mails) aura le fichier de manifeste suivant :</p>

<pre class="brush: js">{
  &quot;name&quot;: &quot;Social&quot;,
  &quot;role&quot;: &quot;collection&quot;,
  &quot;provider_id&quot;: &quot;289&quot;, // identifiant pour la recherche adaptative
  &quot;apps&quot;: [
    [&quot;apps&quot;, &quot;communications&quot;, &quot;dialer&quot;],
    [&quot;apps&quot;, &quot;sms&quot;],
    [&quot;apps&quot;, &quot;communications&quot;, &quot;contacts&quot;],
    [&quot;apps&quot;, &quot;email&quot;]
  ],
  &quot;default_locale&quot;: &quot;en-US&quot;,
  &quot;icons&quot;: {
    &quot;60&quot;: &quot;/collections/social/icon.png&quot;,
    &quot;90&quot;: &quot;/collections/social/icon@1.5x.png&quot;,
    &quot;120&quot;: &quot;/collections/social/icon@2x.png&quot;
  }
 }</pre>

<p><strong>Les applications distantes</strong> sont fournies par le moteur de recherche adaptative lors de l&apos;exécution et quand l&apos;appareil est connecté.</p>

<h5 id="Traduire_les_collections">Traduire les collections</h5>

<p>Les traductions pour les collections doivent être définies dans les fichiers de locales pour l&apos;application <em>Écran d&apos;accueil</em> dans le répertoire <code>apps/collection/locales/</code>. Chaque fichier de locale devra avoir un nom structurant avec la structure <code>collections.&lt;codeLangue&gt;.properties</code> — avec <code>&lt;codeLangue&gt;</code> qui vaut, par exemple, <code>fr</code> pour le français. Ce fichier contient des lignes simples qui contiennent les identifiants des chaînes anglaises associées à leur traduction. Voici un exemple pour la locale française :</p>

<pre># Add bookmark to homescreen
add-to-home-screen=Ajouter à l’écran d’accueil
add-to-home-screen-header=Ajouter un lien
website-name=Nom du site web
address=Adresse
added-to-home-screen=Ajouté à l’écran d’accueil
</pre>

<h5 id="Collections_personnalisées">Collections personnalisées</h5>

<p>À partir de Firefox OS 1.3, vous pouvez définir vos propres collections. Pour cela, il suffit de créer la collection dans le répertoire <a href="https://github.com/mozilla-b2g/gaia/tree/master/apps/collection/collections">collection</a>, et de les référencer dans le fichier <code>collections.json</code> vu avant.</p>

<h4 id="Les_propriétés_de_l&apos;écran_d&apos;accueil_vertical">Les propriétés de l&apos;écran d&apos;accueil vertical</h4>

<p>À partir de Firefox 2.0, il est possible de choisir une disposition verticale (plutôt que des pages horizontales) pour l&apos;écran d&apos;accueil. Les propriétés de l&apos;écran d&apos;accueil sont définies dans le fichier <a href="https://github.com/mozilla-b2g/gaia/blob/master/apps/verticalhome/build/default-homescreens.json">default-homescreens.json</a> qui décrit les applications, les collections et les marque-pages à afficher ainsi que le nombre de colonnes pour l&apos;écran d&apos;accueil.</p>

<h3 id="network.json_(ce_fichier_n&apos;apparait_pas_dans_le_dossier_de_personnalisation)">network.json (ce fichier n&apos;apparait pas dans le dossier de personnalisation)</h3>

<div class="warning notecard">
<p><strong>Important</strong> : Cette personnalisation n&apos;est plus supportée depuis Firefox OS 1.4+.</p>
</div>

<p>Dans les versions de Firefox OS &lt; 1.4, ce fichier peut être créé dans <code>gaia/apps/settings/resources</code>. Il permet de définir les types de réseaux supportés par l&apos;appareil. Firefox OS fonctionne sur les types de réseaux suivants :</p>

<ul>
 <li>&apos;wcdma/gsm&apos; (WCDMA de préférence)</li>
 <li>&apos;gsm&apos;</li>
 <li>&apos;wcdma&apos;</li>
 <li>&apos;wcdma/gsm-auto&apos; (GSM de préférence)</li>
 <li>&apos;cdma/evdo&apos; (CDMA de préférence)</li>
 <li>&apos;cdma&apos;</li>
 <li>&apos;evdo&apos;</li>
 <li>&apos;wcdma/gsm/cdma/evdo&apos; (Automatique)</li>
</ul>

<p>Voici un exemple de fichier :</p>

<pre class="brush: js">{
  &quot;types&quot;:  [
    &quot;cdma/evdo&quot;,
    &quot;cdma&quot;, &quot;evdo&quot;
  ]
}</pre>

<h3 id="settings.json">settings.json</h3>

<ul>
 <li>Réglages généraux : 1.0.1</li>
 <li>Fournisseur de recherche par défaut pour la Rocketbar : 2.0</li>
</ul>

<p>Ce fichier permet de définir les valeurs par défaut pour le fond d&apos;écran, les sonneries, l&apos;activation ou non de l&apos;écran de verrouillage, l&apos;activation ou non du bluetooth, etc. Vous pouvez consulter le fichier <a href="https://github.com/mozilla-b2g/gaia/blob/master/build/config/common-settings.json">build/config/common-settings.json</a> pour déterminer les réglages possibles. Par exemple, vous pouvez inclure la ligne <code>&quot;wifi.enabled&quot;:false</code> pour désactiver le wifi par défaut.</p>

<p>Les réglages personnalisés sont à placer dans le fichier <a href="https://github.com/mozilla-b2g/gaia/blob/master/customization/settings.json">customization/settings.json</a>.</p>

<h4 id="Fournisseur_de_recherche_par_défaut_pour_la_Rocketbar">Fournisseur de recherche par défaut pour la Rocketbar</h4>

<p>Dans Firefox OS 2.0 et les versions supérieures, les paramètres suivants peuvent être ajoutés dans le fichier <code>settings.json</code>, pour définir le fournisseur de recherche par défaut pour la Rocketbar :</p>

<pre>&quot;search.urlTemplate&quot;: &quot;https://www.google.com/search?q={searchTerms}&quot;,
&quot;search.suggestionsUrlTemplate&quot;: &quot;https://www.google.com/complete/search?client=firefox&amp;q={searchTerms}&quot;,
&quot;search.iconUrl&quot;: &quot;data:image/x-icon;base64,AAABAAIAEBAAAAAAAAB9AQAAJ [TRONQUÉ POUR L&apos;EXEMPLE]
</pre>

<h3 id="Personnaliser_le_moteur_de_recherche">Personnaliser le moteur de recherche</h3>

<p>À partir de Firefox 2.0+, il existe une liste par défaut pour les différents moteurs de recherches et les fichiers d&apos;icônes associés : <a href="/en-US/docs/https://github.com/mozilla-b2g/gaia/blob/master/apps/settings/resources/search/providers.json">apps/settings/resources/search/providers.json</a>. Vous pouvez configurer cette liste lors de la construction en éditant le fichier <a href="https://github.com/mozilla-b2g/gaia/blob/master/customization/search/providers.json">customization/search/providers.json</a> et en ajoutant les fichiers d&apos;icônes appropriés dans le même répertoire. Le contenu de ce répertoire écrasera <code>app/settings/resources/search</code> s&apos;il existe et si vous avez lancé la construction avec la commande <code>make production GAIA_DISTRIBUTION_DIR=customization</code>.</p>

<h3 id="Personnaliser_les_applications_par_défaut_de_l&apos;écran_d&apos;accueil">Personnaliser les applications par défaut de l&apos;écran d&apos;accueil</h3>

<p><code>homescreen.appName</code> vous permet de définr des applications comme applications par défaut pour l&apos;écran d&apos;accueil.</p>

<pre class="brush: js">{ &quot;homescreen.appName&quot;: &quot;homescreen-stingray&quot; }
</pre>

<h3 id="sms-blacklist.json">sms-blacklist.json</h3>

<p>Ce fichier contient une liste finie de numéros de téléphone pour lesquels il ne sera pas possible d&apos;envoyer des SMS. Cette liste surchargera le fichier <code>blacklist.json</code> de l&apos;application SMS si elle existe. Les numéros de téléphone sont définis dans un tableau comme suit :</p>

<pre>[&quot;11223344&quot;, &quot;55667788&quot;]</pre>

<h3 id="cellbroadcast">cellbroadcast</h3>

<p>Canaux d&apos;écoute :</p>

<ul>
 <li>Disponible lors de l&apos;utilisation dans les Réglages <code>ril.cellbroadcast.searchlist</code></li>
 <li>type : chaîne de caractères</li>
 <li>format valide : <code>\d(-\d)?(,\d(-\d))*</code></li>
</ul>

<p>Désactiver le rapport d&apos;événement :</p>

<ul>
 <li>Disponible
  <ul>
   <li>lors de l&apos;utilisation : dans les Réglages — <code>ril.cellbroadcast.disabled</code></li>
   <li>lors dans la construction : dans les préférences utilisateurs — <code>ril.cellbroadcast.disabled</code></li>
  </ul>
 </li>
 <li>Type : booléen</li>
 <li>Signification : vaut <code>true</code> pour désactiver la diffusion depuis la cellule du téléphone (<em>Cell Broadcast reporting</em>).</li>
</ul>

<div class="note notecard">
<p><strong>Note </strong>: Les paramètres par défaut sont disponibles dans le fichier <a href="https://mxr.mozilla.org/gaia/source/shared/resources/apn/operator_variant.xml">operator_variant.xml</a>.</p>
</div>

<h3 id="support.json">support.json</h3>

<p>Ce fichier contient des contacts pour l&apos;assistance (en ligne ou téléphonique). Lorsque ce fichier est renseigné, il écrasera le fichier <code>support.json</code> contenu dans l&apos;application Paramètres. Pour conserver les contacts par défaut, il faudra les copier du fichier original sur le fichier de personnalisation puis ajouter vos nouveaux contacts.</p>

<p>Voici un exemple de fichier JSON :</p>

<pre class="brush: js">{
   &quot;onlinesupport&quot;: {
     &quot;href&quot;: &quot;http://support.mozilla.org/&quot;,
     &quot;title&quot;: &quot;Mozilla Support&quot;
   },
   &quot;callsupport&quot;: [
     {
       &quot;href&quot;: &quot;tel:12345678&quot;,
       &quot;title&quot;: &quot;Assistance tél. 1&quot;
     },
     {
       &quot;href&quot;: &quot;tel:87654321&quot;,
       &quot;title&quot;: &quot;Assistance tél. 2&quot;
     }
   ]
 }</pre>

<h3 id="Profil_pour_l&apos;agent_utilisateur_WAP_(wapuaprof.json)">Profil pour l&apos;agent utilisateur WAP (wapuaprof.json)</h3>

<p>Le profil d&apos;agent utilisateur WAP peut surcharger l&apos;agent utilisateur lors de l&apos;envoi de paquets WAP. Si vous souhaitez surcharger le profil d&apos;agent utilisateur (<em>user agent profile</em>) par défaut avec des informations MCC/MNC, vous pouvez utiliser ce fichier (voir les explications supplémentaires dans <a href="#runtime_customization">runtime customization</a>).</p>

<h3 id="apps.list">apps.list</h3>

<p>Ce fichier vous permet de définir les applications que vous souhaitez charger à l&apos;exécution (de façon semblable à <code>variant.json</code>, comme expliqué ci-après dans le paragraphe <a href="#Applications">Applications</a>). Les applications sont listées de la façon suivante :</p>

<pre class="brush: bash">apps/*
external-apps/*
outoftree_apps/*</pre>

<p>Vous pouvez lister des applications spécifiques plutôt que des répertoires entiers :</p>

<pre class="brush: bash">apps/email
apps/settings</pre>

<div class="note notecard">
<p><strong>Note</strong> : Si vous souhaitez ajouter des applications externes dans votre version de Gaia, vous devrez les construire d&apos;une certaine façon et les placer dans le répertoire <code>gaia/external-apps/</code>. Lire le paragraphe <a href="#Building_Prebundled_web_apps">Building Prebundled web apps</a> pour plus d&apos;informations à ce sujet.</p>
</div>

<div class="warning notecard">
<p><strong>Important </strong>: Si vous distribuez une version adaptée de Firefox OS avec des applications externes intégrées, vous devez respecter l&apos;accord de distribution avec Mozilla (Mozilla&apos;s Distribution Agreement).</p>
</div>

<h2 id="Les_autres_options_de_personnalisation">Les autres options de personnalisation</h2>

<p>D&apos;autres aspects de Gaia peuvent être personnalisés. C&apos;est aspects sont décrits ici.</p>

<div class="note notecard">
<p><strong>Note </strong>: Le script de construction utilisé pour la plupart des paragraphes suivants est <a href="https://github.com/mozilla-b2g/gaia/blob/master/build/applications-data.js">gaia/build/applications-data.js</a>. Il est copié dans un fichier <code>init.json</code> qui se situe dans le répertoire de l&apos;application du navigateur lors de la construction.</p>
</div>

<h3 id="Marque-pages_et_moteurs_de_recherche_par_défaut_du_navigateur">Marque-pages et moteurs de recherche par défaut du navigateur</h3>

<ul>
 <li>Marque-pages : 1.0.1</li>
 <li>Moteurs de recherche par défaut : 1.2</li>
</ul>

<p>Les marque-pages et moteurs de recherche par défaut peuvent être personnalisés lors de la construction et on peut avoir différentes variantes pour chacun des pays au sein d&apos;une même version. Les données personnalisées sont insérées dans l&apos;application du navigateur la première fois qu&apos;il est lancé en fonction des codes <a href="http://en.wikipedia.org/wiki/Mobile_country_code">MCC / MNC</a> de la carte SIM de l&apos;appareil à ce moment.</p>

<div class="note notecard">
<p><strong>Note</strong> : Les marque-pages peuvent être personnalisés depuis la version 1.0.1 de Firefox OS mais la procédure a été modifiée avec la version 2.1 (ce qui est expliqué dans le paragraphe suivant). Les moteurs de recherches peuvent être personnalisés à partir de Firefox OS 1.2.</p>
</div>

<p>L&apos;exemple ci-après (<code>browser.json</code>) illustre une configuration pour l&apos;opérateur Vivo au Brésil (724006 avec 724 pour le Brésil et 006 pour Vivo selon la codification MCC / MNC), ainsi que le cas par défaut (000000) présent au cas où la carte SIM ne correspondrait pas à l&apos;opérateur ou au cas où la carte SIM est absente de l&apos;appareil.</p>

<pre class="brush: js">content = {
   &apos;000000&apos;: {
     &apos;bookmarks&apos;: [
       { &apos;title&apos;: &apos;Mozilla&apos;,
         &apos;uri&apos;: &apos;https://mozilla.org&apos;,
         &apos;iconUri&apos;:
           &apos;data:image/png;base64,AAABAAIAEBAAAAEAIABo[tronqué]&apos;
       },
       { &apos;title&apos;: &apos;Firefox OS&apos;,
         &apos;uri&apos;: &apos;https://mozilla.org/firefoxos&apos;,
         &apos;iconUri&apos;:
           &apos;data:image/png;base64,AAABAAIAEBAAAAEA[tronqué]&apos;
       }
     ],
     &apos;searchEngines&apos; : [
        {
          &apos;title&apos;: &apos;Google&apos;,
          &apos;uri&apos;: &apos;https://www.google.com/search?q={searchTerms}&apos;,
          &apos;iconUri&apos;:
            &apos;data:image/png;base64,AAABAAIAEBAAAAEAIABoBAA[tronqué]&apos;
        }
      ],
      &apos;settings&apos; : {
        &apos;defaultSearchEngine&apos;: &apos;https://www.google.com/search?q={searchTerms}&apos;
      }
   },

   &apos;724006&apos;: {
     &quot;bookmarks&quot;: [
       { &quot;title&quot;: &quot;Vivo Busca&quot;,
         &quot;uri&quot;: &quot;https://www.google.com.br/m/search&quot;,
         &quot;iconUri&quot;: &quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC[tronqué]&quot;
       },
       { &quot;title&quot;: &quot;Serviços e Downloads&quot;,
         &quot;uri&quot;: &quot;http://vds.vivo.com.br&quot;,
         &quot;iconUri&quot;: &quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACA[tronqué]&quot;
       },
       {
         &quot;title&quot;: &quot;Site Vivo&quot;,
         &quot;uri&quot;: &quot;http://www.vivo.com.br/conteudosmartphone&quot;,
         &quot;iconUri&quot;: &quot;data:image/jpg;base64,/9j/4AAQSkZJRg[tronqué]&quot;
       }
     ],
     &apos;searchEngines&apos; : [
        {
          &apos;title&apos;: &apos;Yahoo&apos;,
          &apos;uri&apos;: &apos;https://search.yahoo.com/search?q={searchTerms}&apos;,
          &apos;iconUri&apos;:
            &apos;data:image/png;base64,AAABAAIAEBAAAAEAIABoBAA[tronqué]&apos;
        }
      ],
      &apos;settings&apos; : {
        &apos;defaultSearchEngine&apos;: &apos;https://search.yahoo.com/search?q={searchTerms}&apos;
      }
   }
 };</pre>

<p>Pour cet exemple, si la carte SIM de l&apos;appareil est une carte de l&apos;opérateur Vivo au Brésil, lors de la première utilisation, l&apos;utilisateur verra les marque-pages Vivo et aura Yahoo comme moteur de recherche par défatu. Si une autre carte (ou aucune carte) est présente dans l&apos;appareil lors de la première utilisation, l&apos;utilisateur verra les marque-pages Mozilla ainsi que le moteur de recherche Google. Plusieurs aspects importants sont à noter :</p>

<ul>
 <li>La propriété  <code>defaultSearchEngine</code> <em>doit</em> correspondre à la propriété <code>uri</code> du moteur de recherche défini. Cette chaîne de caractères sera utilisée comme modèle pour les différentes requête. <code>{searchTerms}</code> sera remplacé par les termes saisis par l&apos;utilisateur pour la recherche. D&apos;autres chaînes de caractères complétant la recherche peuvent être ajouté après cette variable dans les différentes URL .</li>
 <li>Les URL pour les icônes sont des dataURI encodées en base 64 (tronquées pour l&apos;exemple) et non pas des URL HTTP. Cela permet de faire apparaître les icônes lors de la première utilisation et ce même si l&apos;appareil n&apos;est pas connecté à Internet.</li>
 <li>Il est donc possible d&apos;avoir un fichier qui contient différents cas pour différents opérateurs dans différents pays. Chaque variant étant représentée par un code à 6 chiffres composé du code MCC suivi du code MNC (les deux codes étant préfixés de &apos;0&apos; si nécessaire afin qu&apos;ils soient chacun sur trois chiffres)</li>
 <li>Lorsque la navigateur devra prendre connaissance du réglage (à la première utilisation), il consultera le fichier pour trouver une correspondance avec les codes MCC et MNC, s&apos;il n&apos;en trouve pas, il cherchera une correspondance avec MCC+000, s&apos;il n&apos;y a toujours pas de correspondance, il utilisera le code 000000.</li>
 <li>Lors des mises à jour de Gaia, les nouvelles personnalisations ne seront appliquées que pour les nouvelles fonctionnalités. Si la fonctionnalité était déjà présente, l&apos;ancienne adaptation ne sera pas surchargée.</li>
</ul>

<div class="note notecard">
<p><strong>Note </strong>: L&apos;application du navigateur affichera les marque-pages dans le sens opposé (ex : le premier marque-page du fichier JSON sera affiché en dernier, etc.).</p>
</div>

<h3 id="Personnalisation_de_la_liste_des_fournisseurs_de_recherche_pour_la_Rocketbar">Personnalisation de la liste des fournisseurs de recherche pour la Rocketbar</h3>

<ol>
 <li>Il est également possible d&apos;adapter le fournisseur de recherche par défaut (et la liste des fournisseurs) pour la Rocketbar. Cette personnalisation se base également sur les codes MCC/MNC. Pour définir les fournisseurs de recherche, il faut modifier deux fichiers JSON :
  <ul>
   <li>La liste des fournisseurs par MCC/MNC qui est définie dans le fichier <a href="https://github.com/mozilla-b2g/gaia/blob/master/customization/mobizilla/mobizilla_search.json">mobizilla_search.json</a> pour notre exemple,</li>
   <li>Le fournisseur de recherche par défaut pour la Rocketbar qui est défini dans le fichier <a href="https://github.com/mozilla-b2g/gaia/blob/master/customization/mobizilla/mobizilla_default_search.json">mobizilla_default_search.json</a> pour notre exemple.</li>
  </ul>
 </li>
 <li><a href="https://github.com/mozilla-b2g/gaia/blob/master/customization/variant.json">variant.json</a> définit ensuite les fichiers <code>.json</code> à utiliser pour chaque paire MCC/MNC. Ainsi, dans notre exemple, aux <a href="https://github.com/mozilla-b2g/gaia/blob/master/customization/variant.json#L47-L48">lignes 47 et 48</a>, on a :
  <pre class="brush: json">&quot;search&quot;: &quot;mobizilla/mobizilla_search.json&quot;,
&quot;default_search&quot;: &quot;mobizilla/mobizilla_default_search.json&quot;,</pre>
 </li>
 <li><code>variant.json</code> doit être placé dans le répertoire racine consacré à la distribution de votre version.</li>
 <li>Afin d&apos;appliquer cette configuration, pour la construction de Gaia la variable <code>GAIA_DISTRIBUTION_DIR</code> doit correspondre au chemin de votre répertoire consacré à la distribution de votre version.</li>
</ol>

<h3 id="Réglages_pour_les_données_et_les_messages">Réglages pour les données et les messages</h3>

<p>Il est possible d&apos;adapter les réglages pour les données et les messages lors de l&apos;exécution.</p>

<p>Pour ajouter des réglages spécifiques, il suffit d&apos;éditer <code>gaia/shared/resources/apn/apns_conf_local.xml</code> en ajoutant ou en éditant des bloc pour chaque opérateur téléphonique :</p>

<pre class="brush: xml"> &lt;apn carrier=&quot;Réseau Test&quot;
      mcc=&quot;001&quot;
      mnc=&quot;01&quot;
      apn=&quot;internet&quot;
      user=&quot;user&quot;
      password=&quot;password&quot;
      proxy=&quot;127.0.0.1&quot;
      port=&quot;8080&quot;
      mmsc=&quot;http://127.0.0.1&quot;
      mmsproxy=&quot;127.0.0.1&quot;
      mmsport=&quot;8080&quot;
      authtype=&quot;0&quot;
      type=&quot;default,supl,mms&quot;
  /&gt;</pre>

<h3 id="Réglages_concernant_la_messagerie_et_la_diffusion_cellulaire">Réglages concernant la messagerie et la diffusion cellulaire</h3>

<p>Pour appliquer des changements spécifiques à la boîte vocale et à la diffusion cellulaire, il suffit de modifier le fichier <code>gaia/shared/resources/apn/operator_variant.xml</code> en ajoutant ou en éditant des blocs pour les opérateurs de la forme suivante :</p>

<pre class="brush: xml">   &lt;operator carrier=&quot;Réseau Test avec variante par opérateur&quot;
       mcc=&quot;001&quot;
       mnc=&quot;01&quot;
       cellBroadcastSearchList=&quot;0,1,2,3&quot;
       voicemail=&quot;999999&quot;
   /&gt;</pre>

<h3 id="Profil_de_l&apos;agent_utilisateur_WAP">Profil de l&apos;agent utilisateur WAP</h3>

<p>Le profil d&apos;agent utilisateur WAP peut également être personnalisé lors de l&apos;exécution et surcharge les informations de l&apos;agent utilisateur lorsque le téléphone envoie des paquets WAP. En fonction des codes MCC/MNC, le profil peut être personnalisé grâce aux propriétés<code> url</code> et <code>tagname</code> . L&apos;implémentation actuelle ne tient compte que de la propriété <code>url</code>.</p>

<p>Le profil d&apos;agent utilisateur WAP utilise ici le même format que pour l&apos;application Navigateur. &quot;000000&quot; est utilisé comme profil par défaut. Voici un exemple :</p>

<pre class="brush: js">   {
     &quot;000000&quot;: {
       &quot;url&quot;: &quot;http://example.url/default.xml&quot;
     },
     &quot;123001&quot;: {
       &quot;url&quot;: &quot;http://example.url/custom123001.xml&quot;
     }
   }</pre>

<p>Pour cet exemple, l&apos;URL du profile par défaut est <code>http://example.url/default.xml</code> ; pour les codes MCC = 123 et MNC = 001, l&apos;URL sera <code>http://example.url/custom123001.xml</code>. S&apos;il y avait une autre carte dont les codes seraient MCC = 123 et MNC = 100, l&apos;URL utilisée serait alors <code>http://example.url/default.xml</code>.</p>

<p>Si jamais l&apos;élément dont le code est 000000 était retiré :</p>

<pre class="brush: js">  {
     &quot;123001&quot;: {
       &quot;url&quot;: &quot;http://example.url/custom123001.xml&quot;
     }
   }</pre>

<p>le profil utilisé par la carte dont les codes sont MCC = 123 et MNC = 001 serait désormais basé sur <code>http://example.url/custom123001.xml</code>. Les profils des autres codes ne seraient pas surchargés.</p>

<p>Si on gardait &quot;000000&quot; et que &quot;123001&quot; ne possèdait pas d&apos;URL :</p>

<pre class="brush: js">   {
     &quot;000000&quot;: {
       &quot;url&quot;: &quot;http://example.url/default.xml&quot;
     },
     &quot;123001&quot;: {}
   }</pre>

<p>tous les profils seraient surchargés avec l&apos;URL <code>http://example.url/default.xml</code></p>

<h3 id="Applications">Applications</h3>

<p>Les applications installées dans Firefox OS peuvent être adaptées lors de l&apos;exécution (voir <a href="/en-US/Firefox_OS/Platform/Gaia/Hacking#Customizing_the_build-time_apps">personnaliser les applications présentes lors de la construction</a>). Pour personnaliser les applications en fonction de l&apos;opérateur, il est possible d&apos;utiliser le fichier <code>variant.json</code> pour déterminer quelles applications installer et comment les placer sur l&apos;écran d&apos;accueil. Les applications tierces seront ajoutées à la liste avec les applications standard.</p>

<p>La portion intéressante du fichier <code>variant.json</code> ressemblera à cela :</p>

<pre class="brush: js">   {
     &quot;apps&quot;: {
       &quot;puzzle&quot;:
         {
           &quot;manifestURL&quot;: &quot;https://owd.tid.es/store/packages/fe8e4a866c518a42db9d2041568684c1.webapp&quot;
         },
       &quot;store&quot;:
         {
           &quot;manifestURL&quot;: &quot;https://owd.tid.es/store/manifest.webapp&quot;,
           &quot;installOrigin&quot;: &quot;https://www.openwebdevice.com&quot;
         }
     },
     &quot;operators&quot;: [
       {
         &quot;id&quot;: &quot;movistar-co&quot;,
         &quot;mcc-mnc&quot;: [
           &quot;214-01&quot;,
           &quot;214-02&quot;
         ],
         &quot;apps&quot;: [
           {
             &quot;id&quot;: &quot;store&quot;,
             &quot;screen&quot;: 0,
             &quot;location&quot;: 2
           }
         ]
       },
       {
         &quot;id&quot;: &quot;movistar-mx&quot;,
         &quot;mcc-mnc&quot;: [
           &quot;215-23&quot;
         ],
         &quot;apps&quot;: [
           {
             &quot;id&quot;: &quot;store&quot;,
             &quot;screen&quot;: 0,
             &quot;location&quot;: 2
           },
           {
             &quot;id&quot;: &quot;puzzle&quot;
           }
         ]
       }
     ]
   }</pre>

<ul>
 <li>Le premier objet de la structure JSON est<code> apps</code>, et permet de définir les applications tierces à copier lors de la construction. Dans cet exemple, on a deux applications : une application hébergée (<code>store</code>) et une application empaquetée (<code>puzzle</code>). Les applications empaquetées auront besoin de <code>manifestURL</code>, les applications hébergées auront, en plus, besoin de <code>installOrigin</code> pour pouvoir être téléchargées.</li>
 <li>Le deuxième objet, appelé <code>operators</code>, permet de définir la configuration en fonction du code MCC/MNC. L&apos;objet contient un tableau d&apos;objets pour chaque paire MCC/MNC. Ces objets définissent l&apos;identifiant <code>id</code>, une liste MCC/MNC correspondant à la configuration ainsi qu&apos;une liste d&apos;objets <code>apps</code> qui définit les applications à installer à l&apos;exécution pour chaque cas.</li>
 <li>Chaque objet <code>apps</code> possède une propriété <code>id</code> obligatoire ainsi que deux propriétés optionnelles qui permettront de placer l&apos;application visuellement :
  <ul>
   <li>La propriété <code>screen</code> définit le numéro de l&apos;écran sur lequel placer l&apos;application.</li>
   <li>La propriété <code>location</code> définit la position de l&apos;application sur cet écran.</li>
  </ul>
 </li>
</ul>

<h3 id="Les_autres_personnalisations_utilisant_un_fichier_de_variante">Les autres personnalisations utilisant un fichier de variante</h3>

<p>Le fichier <code>variant.json</code> (le même que précedemment) permet également de configurer des ressources spécifiques grâce à des attributs relatifs à chaque opérateurs. Un opérateur pourra avoir les réglages suivants :</p>

<pre class="brush: js">   {
     &quot;apps&quot;: {
       ...
     },
     &quot;operators&quot;: [
       {
         &quot;id&quot;: &quot;movistar-co&quot;,
           &quot;mcc-mnc&quot;: [
             &quot;214-01&quot;,
             &quot;214-02&quot;
           ],
         &quot;apps&quot;: [
           {
             &quot;id&quot;: &quot;store&quot;,
             &quot;screen&quot;: 0,
             &quot;location&quot;: 2
           }
         ],
         &quot;support_contacts&quot;: &quot;resources/support_contacts_movistar.json&quot;,
         &quot;default_contacts&quot;: &quot;resources/contacts_movistar.json&quot;,
         &quot;ringtone&quot;: {
           &quot;path&quot;: &quot;resources/Movistar_Mid_ABR_128kbps.ogg&quot;,
           &quot;name&quot;: &quot;Tono Movistar&quot;
         },
         &quot;wallpaper&quot;: &quot;resources/customize.jpg&quot;,
         &quot;keyboard&quot;: &quot;resources/keyboard_movistar.json&quot;,
         &quot;network_type&quot;: &quot;resources/network_type_movistar.json&quot;,
         &quot;known_networks&quot;: &quot;resources/known_networks_movistar.json&quot;,
         &quot;data_ftu&quot;: true,
         &quot;sms&quot;: &quot;resources/sms_movistar.json&quot;,
         &quot;topsites&quot;: &quot;resources/topsites_movistar.json&quot;,
         &quot;bookmarks&quot;: &quot;resources/bookmarks_movistar.json&quot;,
         &quot;data_roaming&quot;: true,
         &quot;power&quot;: {
           &quot;poweron&quot;: {
             &quot;video&quot;: &quot;app://operatorresources/resources/power/latam_power_on.mp4&quot;
           },
           &quot;poweroff&quot;: {
             &quot;video&quot;: &quot;resources/latam_power_off.mp4&quot;
           }
         },
         &quot;nfc&quot;: true
       }
       ...
     ]
   }
</pre>

<p>Les différents réglages présentés dans le fichier sont détaillés ci-après :</p>

<h4 id="Contacts_d&apos;assistance">Contacts d&apos;assistance</h4>

<p>La propriété <code>support_contacts</code> correspond à un chemin vers un fichier qui contiendra les contacts affichés sur l&apos;écran d&apos;aide (Paramètres &gt; Aide). Cela permet d&apos;avoir les mêmes fonctionnalités que <a href="#support.json">support.json</a>. Le format du fichier attendu à l&apos;emplacement indiqué est le suivant :</p>

<pre class="brush: js">   {
     &quot;onlinesupport&quot;: {
       &quot;title&quot;: &quot;Assistance Mozilla&quot;,
       &quot;href&quot;: &quot;http://test.mozilla.org/support&quot;
     },
     &quot;callsupport1&quot;: {
       &quot;title&quot;: &quot;Assistance téléphonique (1)&quot;,
       &quot;href&quot;: &quot;tel:14155550001&quot;
     },
     &quot;callsupport2&quot;: {
       &quot;title&quot;: &quot;Assistance téléphonique (2)&quot;,
       &quot;href&quot;: &quot;tel:14155550002&quot;
     }
   }</pre>

<h4 id="Contacts_par_défaut">Contacts par défaut</h4>

<p>La propriété <code>default_contacts</code> correspond au chemin vers un fichier qui définit les contacts qui seront préchargés dans l&apos;application Contacts en fonction des codes MCC/MNC. Les noms des différentes sections du fichier seront les codes MCC/MNC, chaque section contient un ensemble de contacts (au même format que pour <a href="#contacts.json">contacts.json</a>). Par exemple :</p>

<pre class="brush: js">    {
        &quot;123123&quot;:
        [
            {name: [&quot;Jean Biche&quot;]},
            // etc
        ],
    }
</pre>

<h4 id="Sonnerie">Sonnerie</h4>

<p>La propriété <code>ringtone</code> permet de définir la sonnerie par défaut. Cet objet contient deux propriétés obligatoires :</p>

<ul>
 <li><code>path</code> : Le chemin vers le fichier audio à utiliser pour la sonnerie.</li>
 <li><code>name</code> : Le nom à afficher pour cette sonnerie dans l&apos;écran des réglages.</li>
</ul>

<h4 id="Fond_d&apos;écran">Fond d&apos;écran</h4>

<p>La propriété <code>wallpaper</code> contient le chemin vers le fichier image (PNG) qui sera utilisé comme fond d&apos;écran par défaut.</p>

<h4 id="Paramètres_clavier">Paramètres clavier</h4>

<p>La propriété <code>keyboard</code> contient le chemin vers un fichier qui contient les informations de configuration pour le clavier. Le format du fichier attendu est le suivant :</p>

<pre class="brush: js"> {
   &quot;keyboard.vibration&quot;: true,
   &quot;keyboard.autocorrect&quot;: false,
   &quot;keyboard.clicksound&quot;: true,
   &quot;keyboard.wordsuggestion&quot;: false
 }</pre>

<h4 id="Indicateurs_de_réseau">Indicateurs de réseau</h4>

<p>La propriété <code>network_type</code> contient le chemin d&apos;un fichier qui contient le texte à utiliser lorsqu&apos;un type de réseau est utilisé par l&apos;appareil. Ce texte apparaîtra dans l&apos;application Réglages, la barre de statut et les réglages rapides.</p>

<p>La barre de statut et les occurences dans l&apos;application Réglages utiliseront le texte contenu dans le fichier. Pour l&apos;écran des réglages rapides, le fichier devra contenir une clé intitulée  <code>data_sprite</code> qui pointe vers un sprite CSS qui contient les icônes pour les différents types de réseaux supportés.</p>

<p>La propriété <code>data_sprite</code> doit correspondre à une URL qui pointe vers une application de l&apos;appareil. Voici un exemple pour un tel fichier :</p>

<pre class="brush: js"> {
  &quot;lte&quot;: &quot;4G&quot;,
  &quot;ehrpd&quot;: &quot;4G&quot;,
  &quot;hspa+&quot;: &quot;H+&quot;,
  &quot;hsdpa&quot;: &quot;H&quot;,
  &quot;hsupa&quot;: &quot;H&quot;,
  &quot;hspa&quot;: &quot;H&quot;,
  &quot;evdo0&quot;: &quot;E&quot;,
  &quot;evdoa&quot;: &quot;E&quot;,
  &quot;evdob&quot;: &quot;E&quot;,
  &quot;1xrtt&quot;: &quot;1x&quot;,
  &quot;umts&quot;: &quot;3G&quot;,
  &quot;edge&quot;: &quot;E&quot;,
  &quot;is95a&quot;: &quot;2G&quot;,
  &quot;is95b&quot;: &quot;2G&quot;,
  &quot;gprs&quot;: &quot;2G&quot;,
  &quot;wcdma/gsm&quot;: &quot;2G/3G GSM auto&quot;,
  &quot;gsm&quot;: &quot;2G GSM&quot;,
  &quot;wcdma&quot;: &quot;3G GSM&quot;,
  &quot;wcdma/gsm-auto&quot;: &quot;2G GSM Preferred&quot;,
  &quot;cdma/evdo&quot;: &quot;2G/3G CDMA auto&quot;,
  &quot;cdma&quot;: &quot;2G CDMA&quot;,
  &quot;evdo&quot;: &quot;3G CDMA&quot;,
  &quot;wcdma/gsm/cdma/evdo&quot;: &quot;2G-3G GSM/CDMA auto&quot;,
  &quot;data_sprite&quot;: &quot;app://operatorresources/resources/quick_settings/images/data-sprite-latam.png&quot;
 }</pre>

<h4 id="SSID_WiFi_pré-paramétrés">SSID WiFi pré-paramétrés</h4>

<p>La propriété <code>known_networks</code> contient un chemin vers un fichier qui liste différents réseaux WiFi. Voici un exemple de fichier :</p>

<pre class="brush: js"> {
  &quot;OPEN&quot;: {
    &quot;ssid&quot;: &quot;OPEN&quot;
  },
  &quot;WEP-WITHOUTKEY&quot;: {
    &quot;ssid&quot;: &quot;wifi-WEP-WITHOUTKEY&quot;,
    &quot;keyType&quot;: &quot;WEP&quot;
  },
  &quot;WEP_KEY&quot;: {
    &quot;ssid&quot;: &quot;WEP-KEYOK&quot;,
    &quot;keyType&quot;: &quot;WEP&quot;,
    &quot;capabilities&quot;: &quot;&quot;,
    &quot;password&quot;: &quot;constrasenya1&quot;
  },
  &quot;WEP_KEYOK_WPS&quot;: {
    &quot;ssid&quot;: &quot;WEP-KEYOK-WPS&quot;,
    &quot;keyType&quot;: &quot;WEP&quot;,
    &quot;capabilities&quot;:&quot;WPS&quot;,
    &quot;password&quot;: &quot;constrasenya1&quot;
  },
  &quot;wpa&quot;: {
    &quot;ssid&quot;: &quot;macaFirefoxHotspot&quot;,
    &quot;keyType&quot;: &quot;WPA-PSK&quot;
  },
  &quot;WPA-PSK_KEY&quot;: {
    &quot;ssid&quot;: &quot;WPA-PSK-KEYOK&quot;,
    &quot;keyType&quot;: &quot;WPA-PSK&quot;,
    &quot;capabilities&quot;:&quot;&quot;,
    &quot;password&quot;: &quot;constrasenya1&quot;
  },
  &quot;WPA-PSK_KEY_WPS&quot;: {
    &quot;ssid&quot;: &quot;WPA-PSK-KEYOK-WPS&quot;,
    &quot;keyType&quot;: &quot;WPA-PSK&quot;,
    &quot;capabilities&quot;:&quot;WPS&quot;,
    &quot;password&quot;: &quot;constrasenya1&quot;
  },
  &quot;WPA-EAP-PSK_WITHOUTEAP&quot;: {
    &quot;ssid&quot;: &quot;WPA-EAP-WITHOUTKEY&quot;,
    &quot;keyType&quot;: &quot;WPA-EAP&quot;
  },
  &quot;WPA-EAP_SIM&quot;: {
    &quot;ssid&quot;: &quot;WPA-EAP-SIM&quot;,
    &quot;keyType&quot;: &quot;WPA-EAP&quot;,
    &quot;eap&quot;: &quot;SIM&quot;,
    &quot;password&quot;: &quot;constrasenya1&quot;
  },
  &quot;WPA-EAP-KEYOK-WPS&quot;: {
    &quot;ssid&quot;: &quot;WPA-EAP-KEYOK-WPS&quot;,
    &quot;keyType&quot;: &quot;WPA-EAP&quot;,
    &quot;eap&quot;: &quot;PEAP&quot;,
    &quot;capabilities&quot;: &quot;WPS&quot;,
    &quot;password&quot;: &quot;constrasenya1&quot;,
    &quot;identity&quot;: &quot;HI\\usr&quot;
  },
  &quot;WPA-EAP-KEYOK-CAPOK-PHASE2-OK&quot;: {
    &quot;ssid&quot;: &quot;WPA-EAP-KEYOK-CAPOK-PHASE2&quot;,
    &quot;keyType&quot;: &quot;WPA-EAP&quot;,
    &quot;eap&quot;: &quot;PEAP&quot;,
    &quot;capabilities&quot;:&quot;WPS&quot;,
    &quot;phase2&quot;: &quot;PAP&quot;,
    &quot;password&quot;: &quot;constrasenya1&quot;,
    &quot;identity&quot;: &quot;HI\\usr&quot;
  }
 }</pre>

<h4 id="ActivationDésactivation_des_données_par_défaut_lors_de_l&apos;expérience_de_première_utilisation">Activation/Désactivation des données par défaut lors de l&apos;expérience de première utilisation</h4>

<p>L&apos;attribut <code>data_ftu</code> définit si oui ou non les données sont activées pendant l&apos;expérience de première utilisation (<em>FTU</em> pour <em>First Time Use</em>). Cette propriété est une valeur booléenne.</p>

<h4 id="Nombre_maximum_de_SMS_à_convertir_en_MMS">Nombre maximum de SMS à convertir en MMS</h4>

<p><code>sms</code> contient le chemin vers un fichier permettant de paramétrer les aspects relatifs aux SMS. Actuellement le seul attribut présent correspond au nombre de SMS pouvant être convertis en MMS. Par exemple :</p>

<pre class="brush: js"> {
  &quot;smsMaxConcat&quot;: 9
 }</pre>

<h4 id="Initialiser_les_sites_les_plus_visités_du_navigateur">Initialiser les sites les plus visités du navigateur</h4>

<p>La propriété <code>topsites</code> contient le chemin vers un fichier qui liste les sites à faire apparaître. Un objet de ce tableau contient la propriété <code>title</code> (chaîne de caractères), <code>uri</code> (l&apos;url) et <code>iconPath</code>. Voici un fichier d&apos;exemple :</p>

<pre class="brush: js">{
  &quot;topsites&quot;: [
    {
      &quot;title&quot;: &quot;Movistar&quot;,
      &quot;uri&quot;: &quot;http://www.movistar.es&quot;,
      &quot;iconPath&quot;: &quot;resources/movistar.ico&quot;
    }
  ]
}</pre>

<h4 id="Marque-pages">Marque-pages</h4>

<div class="note notecard">
<p><strong>Note</strong> : Pour plus d&apos;informations sur la personnalisation des marque-pages pour les versions antérieures de Firefox OS, voir le paragraphe <a href="#Browser_bookmarks_and_default_search_engines">Browser bookmarks and default search engines</a>.</p>
</div>

<p><code>bookmarks</code> contient le chemin d&apos;un fichier listant les objets marque-pages. Un objet correspondant à un marque-page contient trois paramètres : <code>title</code>, pour le titre, <code>uri</code>, pour l&apos;URL du site marqué et <code>iconPath</code> pour l&apos;icône à afficher sur le téléphone. Par exemple :</p>

<pre class="brush: js">{
  &quot;bookmarks&quot;: [
    {
      &quot;title&quot;: &quot;Google&quot;,
      &quot;uri&quot;: &quot;http://www.google.es&quot;,
      &quot;iconPath&quot;: &quot;resources/google.ico&quot;
    }
  ]
}</pre>

<h4 id="ActivationDésactivation_de_l&apos;itinérance_des_données_par_défaut">Activation/Désactivation de l&apos;itinérance des données par défaut</h4>

<p>L&apos;attribut <code>data_roaming</code> permet de définir si oui ou non l&apos;itinérance des données est activée par défaut. C&apos;est un booléen (sa valeur est <code>true</code> ou <code>false</code>).</p>

<h4 id="Animation_à_l&apos;allumageextinction">Animation à l&apos;allumage/extinction</h4>

<p>Les animations d&apos;allumage/extinction sont configurées grâce à un objet qui sera la valeur de la propriété <code>power</code>. Cet objet possède deux propriétés : la première concerne l&apos;animation à utiliser quand le téléphone est démarré (<code>poweron</code>), la seconde correspond à l&apos;animation à utiliser lorsque le téléphone s&apos;éteind. Chacune de ces propriétés contient une clé permettant d&apos;identifier la ressource à utiliser. Cette clé correspond à la propriété <code>video</code> dont la valeur est le chemin vers la ressource à utiliser. Ce chemin peut être local, relativement au système de fichier à utiliser lors de la construction (par exemple : <code>resource/unfichier.png</code>) ou une URI vers un fichier contenu dans une application Gaia qui sera installée sur l&apos;appareil (par exemple : <code>app://nom.domaine/chemin/vers/video.mp4</code>).</p>

<p>Voici un exemple d&apos;objet <code>power</code> :</p>

<pre class="brush: js">&quot;power&quot;: {
  &quot;poweron&quot;: {
    &quot;video&quot;: &quot;app://operatorresources/resources/power/latam_power_on.mp4&quot;
  },
  &quot;poweroff&quot;: {
    &quot;video&quot;: &quot;resources/Power_off_test.mp4&quot;
  }
}</pre>

<h4 id="ActivationDésactivation_du_NFC_par_défaut">Activation/Désactivation du NFC par défaut</h4>

<p>L&apos;attribut <code>nfc</code> booléen définit si oui ou non le NFC (<em>Near Field Communication</em> ou Communication en champ proche) est activé par défaut.</p>

<h2 id="Construire_des_applications_web_pré-empaquetées">Construire des applications web pré-empaquetées</h2>

<p>Dans cet article, nous avons vu comment utiliser le fichier <a href="#apps.list">apps.list</a> pour installer des applications intégrées à votre version. Ces applications doivent être construites selon un certain procédé puis ajoutées au répertoire <code>gaia/external-apps</code>.<br>
 <br>
 Pour construire des applications web pré-empaquetées, vous devrez utiliser le script <a href="https://github.com/mozilla-b2g/preload-app-toolkit">preload-app-toolkit</a> qui permet de construire une application à partir d&apos;une URL<code> .webapp</code>. Ce script peut également accepter les manifestes pour les applications web hébergées et les mini-manifestes pour les applications empaquetées.</p>

<h3 id="Empaqueter_une_seule_application">Empaqueter une seule application</h3>

<p>Déterminez l&apos;URL <code>.webapp</code> correspondant à l&apos;application que vous voulez empaqueter puis lancez la commande suivante :</p>

<pre>python preload.py http://&lt;url de l&apos;application&gt;</pre>

<p>Cela génèrera un répertoire dont le nom sera celui de l&apos;application web (par exemple <code>accuweather</code>).</p>

<h3 id="Empaqueter_plusieurs_applications_(traitement_en_lots)">Empaqueter plusieurs applications (traitement en lots)</h3>

<p>Pour traiter plusieurs applications à la suite, vous pouvez créer un fichier <code>list</code>, contenant l&apos;ensemble des noms des applications et des URL <code>.webapp</code> correspondantes et que vous souhaitez empaqueter. Le fichier ressemblera à celui-ci :</p>

<pre>premiereAppli,https://www.premiereappli.com/manifest.webapp
deuxièmeAppli,https://www.deuxiemeappli.com/manifest.webapp
</pre>

<p>Ce fichier devra être sauvegardé sous le nom <code>list</code> et faire partie du même répertoire que le script <code>preload.py</code>. Vous pouvez ensuite lancer la commande suivante :</p>

<pre>$ python preload.py</pre>

<p>Le script <code>preload.py</code> analysera le fichier fourni et traitera l&apos;ensemble des applications à la suite.</p>

<h3 id="Le_fichier_metadata.json_pour_les_applications_pré-empaquetées">Le fichier metadata.json pour les applications pré-empaquetées</h3>

<p>Chaque application web pré-empaquetée devrait contenir un fichier<code> metadata.json</code>  au sein de son répertoire racine. Le <a href="https://marketplace.firefox.com/">Marketplace Firefox</a> a besoin de ce fichier <code>metadata.json</code> pour gérer les mises à jour automatiques. Ce fichier est généré automatiquement par le script <code>preload.py</code>.<br>
 <br>
 Pour une application web hébergée, les propriétés du fichier <code>metadata.json</code> sont :</p>

<ul>
 <li><code>origin </code>: Le nom de dommaine pour l&apos;URL de l&apos;application web.</li>
 <li><code>manifestURL</code> : L&apos;emplacement du manifeste de l&apos;application web pour l&apos;application hébergée</li>
 <li><code>installOrigin(hosted)</code> : L&apos;emplacement à partir duquel l&apos;application a été installée. Pour les adaptations/personnalisations, cette propriété devrait toujours valoir : <code>https://marketplace.firefox.com</code>.</li>
 <li><code>etag</code> : La propriété <code>etag</code> du manifeste de l&apos;application est utilisé pour vérifier les mises à jour. La valeur de la propriété <code>etag</code> est obtenue grâce à l&apos;entête <code>parse</code> <code>html</code> lors du téléchargement du fichier <code>.webapp</code> depuis le serveur.</li>
 <li><code>external </code>: Champ requis pour Firefox OS 2.1 et ultérieur. Cette propriété vaut <code>true</code> pour les applications pré-empaquetées et <code>false</code> pour les applications non tierces. Cette valeur est utilisée pour déterminer si certains ajustements sont nécessaires pour l&apos;ordre des fichiers dans le fichier application.zip (les ajustement auront lieu lorsque la propriété sera <code>true</code>).</li>
</ul>

<p>Pour une application empaquetée, les propriétés de <code>metadata.json</code> seront :</p>

<ul>
 <li><code>manifestURL</code> : L&apos;emplacement du mini-manifeste. Pour les applications personnalisées, <code>manifestURL</code> proviendra toujours de <code>marketplace.firefox.com</code>.</li>
 <li><code>installOrigin(hosted)</code>: L&apos;emplacement à partir duquel l&apos;application a été installée pour la personnalisation. Pour les personnalisations, cette propriété devrait toujours valoir : <code>https://marketplace.firefox.com</code>.</li>
 <li><code>etag</code> : Cette propriété est utilisée pour les mises à jour. La valeur <code>etag</code> est obtenu à partir de l&apos;en-tête <code>parse html</code> lors de du téléchargement du fichier <code>.webapp</code> depuis le serveur.</li>
 <li><code>external</code> : Ce champ est requis pour les versions de Firefox OS 2.1 et ultérieures. Cette valeur vaudra <code>true</code> pour les applications pré-empaquetées et <code>false</code> pour les applications non-tierces. Cette valeur est utilisée pour déterminer si certains ajustements sont nécessaires pour l&apos;ordre des fichiers dans le fichier application.zip (les ajustement auront lieu lorsque la propriété sera <code>true</code>).</li>
 <li><code>packageEtag</code> : Cette propriété correspond à <code>etag</code> du paquet de l&apos;application. Elle est obtenue grâce l&apos;en-tête <code>parse html</code> lors du téléchargement du paquet via le serveur, une fois qu&apos;une mise à jour a été détectée.</li>
</ul>

<h3 id="Mises_à_jour_automatique_des_applications_empaquetées_le_format_update.webapp">Mises à jour automatique des applications empaquetées : le format update.webapp</h3>

<p>Les applications empaquetées possèdent un fichier <code>update.webapp</code> utilisé pour les mises à jour automatiques. Le format de ce fichier est semblable à celui de <a href="https://developer.mozilla.org/en-US/Apps/Build/Manifest"><code>manifest.webapp</code></a>, mais possède certains attributs supplémentaires :</p>

<ul>
 <li><code>package_path</code> est le chemin vers le fichier du paquet (zip)</li>
 <li><code>size</code> est la taille du paquet en octets.</li>
</ul>

<pre class="brush: js">  {
    &quot;name&quot;: &quot;Game Pack&quot;,
    &quot;icons&quot;: {
      &quot;60&quot;: &quot;/icon-60.png&quot;,
      &quot;128&quot;: &quot;/icon-128.png&quot;
    },
    &quot;version&quot;: &quot;1.1.2&quot;,
    &quot;package_path&quot;: &quot;/application.zip&quot;,
    &quot;developer&quot;: {
      &quot;url&quot;: &quot;http://abc.com&quot;,
      &quot;name&quot;: &quot;abc Inc.&quot;
    },
    &quot;release_notes&quot;: &quot;2nd release&quot;,
    &quot;locales&quot;: {
      &quot;es&quot;: {
        &quot;launch_path&quot;: &quot;/index-es.html&quot;,
        &quot;description&quot;: &quot;show me customization.&quot;
      }
    },
    &quot;size&quot;: 5460141
  }</pre>

<h3 id="Application_pré-empaquetée_au_format_AppCache">Application pré-empaquetée au format AppCache</h3>

<p>Si le fichier <a href="https://developer.mozilla.org/en-US/Apps/Build/Manifest"><code>manifest.webapp</code></a> possède un attribut <a href="https://developer.mozilla.org/en-US/Apps/Build/Manifest#appcache_path"><code>appcache_path</code></a> inclus, le script <code>preload.py</code> ira chercher le fichier AppCache utilisé et ira « pré-chercher » (<em>prefetch</em>) les ressources décrites dans le fichier AppCache. Les applications pré-empaquetée AppCache sont légèrement différentes et Gecko les reconnaîtra dans un format différent. Cela est géré par le script <code>preload.py</code>.</p>

<p>La structure des fichiers traduits sera la suivante :</p>

<pre>    &lt;app name&gt;
       ├── manifest.webapp
       ├── metadata.json
       └── cache
             ├── manifest.appcache
             └── &lt;resources&gt;
</pre>

<div class="note notecard">
<p><strong>Note </strong>: Si le fichier AppCache est nommé différemment dans <code>appcache_path</code>, il devra être renommé en <code>manifest.appcache</code> puis enregistré dans le répertoire <code>cache</code>.</p>
</div>

<h2 id="FAQ">FAQ</h2>

<p>La liste qui suit regroupe les réponse aux questions fréquemment posées sur la personnalisation de Gaia :</p>

<h3 id="Qu&apos;est-ce_qui_peut_être_personnalisé">Qu&apos;est-ce qui peut être personnalisé ?</h3>

<ul>
 <li>La marque
  <ul>
   <li>Les animations d&apos;allumage et d&apos;extinction</li>
   <li>Le nom du réseau dans l&apos;écran de verrouillage et la barre utilitaire</li>
   <li>Les logos affichés lors de la première utilisation</li>
  </ul>
 </li>
 <li>La localisation
  <ul>
   <li>Les locales installées (shared/locales)</li>
   <li>La locale par défaut (<code>GAIA_DEFAULT_LOCALE</code>)</li>
   <li>Les agencements de clavier par défaut (plusieurs claviers peuvent être activés sans être nécessairement liés à la locale)</li>
  </ul>
 </li>
 <li>Les applications
  <ul>
   <li>Disposer d&apos;applications tierces préinstallées</li>
   <li>Placer des applications sur la grille de l&apos;écran d&apos;accueil</li>
   <li>Licensing</li>
   <li>La configuration des paiements dans les applications pour le fournisseur</li>
  </ul>
 </li>
 <li>Les réglages
  <ul>
   <li>La luminosité par défaut de l&apos;écran</li>
   <li>Information sur l&apos;appareil : le nom ou numéro du modèle</li>
   <li>Information sur l&apos;appareil : contenu ou lien sur les termes légaux</li>
   <li>Aide : lien vers une assistance en ligne</li>
   <li>Aide : lien vers une assistance téléphonique</li>
   <li>Aide : lien vers un guide utilisateur</li>
   <li>APN</li>
   <li>Limitation de la taille des MMS</li>
   <li>Mode de réception pour les MMS</li>
  </ul>
 </li>
 <li>Les médias pré-chargés
  <ul>
   <li>Fond d&apos;écran</li>
   <li>Musique</li>
   <li>Vidéos</li>
   <li>Gallerie d&apos;images</li>
  </ul>
 </li>
 <li>Les sons
  <ul>
   <li>Démarrage et extinction</li>
   <li>Sonnerie d&apos;appel</li>
   <li>Sonnerie de message</li>
  </ul>
 </li>
 <li>Everything.me
  <ul>
   <li>Activer ou désactiver la fonctionnalité</li>
   <li>Fournir un ensemble d&apos;applications et/ou de catégories par défaut</li>
  </ul>
 </li>
 <li>Le navigateur
  <ul>
   <li>Marque-pages par défaut</li>
   <li>Moteur de recherche par défaut</li>
  </ul>
 </li>
</ul>

<h3 id="Comment_définir_une_disposition_des_applications_personnalisée">Comment définir une disposition des applications personnalisée ?</h3>

<p>Cette disposition est définie actuellement dans <code>gaia/apps/homescreen/js/init.json</code>. <code>customize.py</code> génèrera la construction au bon format.</p>

<h3 id="Est-il_possible_de_définir_si_une_application_peut_être_retirée_de_l&apos;écran_d&apos;accueil_avec_la_configuration">Est-il possible de définir si une application peut être retirée de l&apos;écran d&apos;accueil avec la configuration ?</h3>

<p>Non. Les applications de <code>/system/b2g</code> ne peuvent pas être retirées, celles contenues dans <code>/data</code> peuvent être retirées. Les applications préchargées provenant de <code>/system</code>, elles doivent être déplacées sous <code>/data</code> si on veut les retirer.</p>

<h3 id="Comment_ajouter_une_application_empaquetée_préchargée_ou_une_application_hébergée_à_la_construction">Comment ajouter une application empaquetée préchargée ou une application hébergée à la construction ?</h3>

<p>Ces applications doivent être ajoutées à <code>gaia/external-apps</code>. <code>customize.py</code> permetttra de gérer les URL pour les applications empaquetées et hébergées puis téléchargera les fichiers à l&apos;emplacement adéquat puis créera <code>metadata.json</code>. Ce fichier servira lors de la construction.</p>

<p>Les méta-données permettront de différencier les applications empaquetées des applications hébergées.</p>

<p>Voir <a href="#Building_Prebundled_web_apps">Building Prebundled web apps</a> pour plus de détails.</p>

<h3 id="Comment_préparer_une_application_hébergée_préchargée_pour_qu&apos;elle_fonctionne_hors_ligne">Comment préparer une application hébergée préchargée pour qu&apos;elle fonctionne hors ligne ?</h3>

<p>Pour cela, il faut fournir les fichiers à fournir en cache dans le répertoire <code>external-apps/MON_APPLICATION/cache</code>, avec le manifeste AppCache.</p>

<p>Voir <a href="#Building_Prebundled_web_apps">Building Prebundled web apps</a> pour plus de détails.</p>

<h3 id="Quelles_adaptations_peuvent_être_effectuées_pour_le_Marketplace">Quelles adaptations peuvent être effectuées pour le Marketplace ?</h3>

<ul>
 <li>Côté appareil
  <ul>
   <li>Pour les paiements, la seule personnalisation possible est l&apos;ajout de fournisseurs de paiements sur une liste blanche. Plusieurs réglages sont disponibles et sont documentés sur la page <a href="https://wiki.mozilla.org/WebAPI/WebPayment#Testing">Web Payments</a>.</li>
   <li>Par exemple, les téléphones Mozilla B2G seront livrés avec <a href="https://github.com/mozilla/webpay#readme">une certaine implémentation pour les fournisseurs de paiement</a> et une liste blanche accessible au Marketplace et aux applications tierces via  <a href="/fr/docs/Web/API/Navigator/mozPay"><code>navigator.mozPay</code></a> pour les paiements au sein des applications. Plus d&apos;informations sur les fournisseurs de paiement sont disponibles <a href="https://wiki.mozilla.org/WebAPI/WebPaymentProvider">sur cette page</a>.</li>
   <li>Tout opérateur peut implémenter son propre processeur de paiement et gérer sa liste blanche. En revanche et à l&apos;heure actuelle, le <a href="https://marketplace.firefox.com/">Marketplace Firefox</a> est le seul configuré pour permettre les achats via le fournisseur de paiement de Mozilla.</li>
  </ul>
 </li>
 <li>Côté serveur
  <ul>
   <li>Le distributeur de l&apos;application fixe un prix pour le produit et le système de paiement de Mozilla détermine la devise à utiliser en fonction du réseau de l&apos;utilisateur. Aucun des aspects concernant les devises, les taxes régionales ou la localisation ne peuvent être gérées sur l&apos;appareil (pour le moment).</li>
   <li>Une catégorie spécifique peut être définie pour l&apos;opérateur avec un logo et un nom sur le Marketplace Firefox.</li>
   <li>Diffuser des applications / promotions sur le Marketplace Firefox, définies par l&apos;opérateur.</li>
  </ul>
 </li>
</ul>

<p>D&apos;autres problématiques sont à gérer selon les régions ou les opérateurs. Voir la page <a href="https://wiki.mozilla.org/Marketplace/AddingRegionsAndCarriers">Ajouter des régions ou des opérateurs</a> pour plus de détails.</p>

<h3 id="Comment_enregistrer_les_modifications_apportées">Comment enregistrer les modifications apportées ?</h3>

<p>Il suffit de sauvegarder uniquement les fichiers modifiés dans les différents emplacements. À l&apos;heure actuelle, plusieurs répertoires sont utilisés au sein du système de fichiers. Pour la version 2 de B2G, ces fichiers pourront être amenés à être stockés dans un seul emplacement (de façon similaire aux répertoires des différentes marques pour Gecko).</p>

<h3 id="Comment_construire_le_produit_avec_une_configuration_spécifique">Comment construire le produit avec une configuration spécifique ?</h3>

<p>Copiez les fichiers modifiés dans une branche de Gaia puis lancez la construction. Pour cela, vous pouvez utiliser <code>customize.py</code> qui, via une interface utilisateur, vous aidera à activer ou non les différentes options, à créer les fichiers adéquats aux bons emplacements puis à construire le profil depuis Gaia.</p>

<h3 id="Comment_personnaliser_l&apos;animation_d&apos;allumageextinction">Comment personnaliser l&apos;animation d&apos;allumage/extinction ?</h3>

<ul>
 <li>Cette animation utilise le format <a href="http://www.droidforums.net/forum/droid-hacks/33932-bootanimation-zip-file-explained.html">Android <code>bootanimation.zip</code>/<code>desc.txt</code></a>.</li>
 <li>Cela permet de créer une animation composées de plusieurs séquences pour lesquelles il est possible de spécifier la taille, le framerate, le nombre de fois qu&apos;une séquence est répétée.</li>
 <li>Une transition PNG animée fait la liaison entre la séquence de <code>bootanimation.zip</code> et l&apos;écran de verrouillage, effectuée par Gaia.</li>
 <li>La taille de l&apos;animation par défaut de l&apos;animation est 8.2Mo (looping) + 3.6Mo (frame 18 transition) soit 11.8Mo au total.</li>
 <li>À l&apos;heure actuelle, l&apos;animation d&apos;extinction est une animation CSS basée sur les spécifications du <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=809342">bug 809342</a>.</li>
</ul>
