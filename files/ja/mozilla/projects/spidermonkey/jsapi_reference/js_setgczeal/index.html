---
title: JS_SetGCZeal
slug: Mozilla/Projects/SpiderMonkey/JSAPI_reference/JS_SetGCZeal
tags:
  - JSAPI Reference
  - SpiderMonkey
translation_of: Mozilla/Projects/SpiderMonkey/JSAPI_reference/JS_SetGCZeal
---
<div><section class="Quick_links" id="Quick_Links">
 <ol>
  <li><a href="/ja/docs/Mozilla/Projects/SpiderMonkey"><strong><em>SpiderMonkey</em></strong></a></li>

  <li><strong>References:</strong></li>
  <li class="toggle">
    <details open>
        <summary>JSAPI reference</summary>
        <ol><li><a href="/ja/docs/Mozilla/Projects/SpiderMonkey/JSAPI_reference/Alphabetical_List"><code>Alphabetical List</code></a> <a href="/ja/docs/Mozilla/Projects/SpiderMonkey/JSAPI_reference/Alphabetical_List$translate" style="opacity: 0.5;">[翻訳する]</a></li><li><a href="/ja/docs/Mozilla/Projects/SpiderMonkey/JSAPI_reference/JS_CompileFile"><code>JS CompileFile</code></a> <a href="/ja/docs/Mozilla/Projects/SpiderMonkey/JSAPI_reference/JS_CompileFile$translate" style="opacity: 0.5;">[翻訳する]</a></li><li><a href="/ja/docs/Mozilla/Projects/SpiderMonkey/JSAPI_reference/JS_ConstructObject"><code>JS ConstructObject</code></a> <a href="/ja/docs/Mozilla/Projects/SpiderMonkey/JSAPI_reference/JS_ConstructObject$translate" style="opacity: 0.5;">[翻訳する]</a></li><li><a href="/ja/docs/Mozilla/Projects/SpiderMonkey/JSAPI_reference/JS_DestroyContext"><code>JS DestroyContext</code></a> <a href="/ja/docs/Mozilla/Projects/SpiderMonkey/JSAPI_reference/JS_DestroyContext$translate" style="opacity: 0.5;">[翻訳する]</a></li><li><a href="/ja/docs/Mozilla/Projects/SpiderMonkey/JSAPI_reference/JS_DestroyRuntime"><code>JS DestroyRuntime</code></a> <a href="/ja/docs/Mozilla/Projects/SpiderMonkey/JSAPI_reference/JS_DestroyRuntime$translate" style="opacity: 0.5;">[翻訳する]</a></li><li><a href="/ja/docs/Mozilla/Projects/SpiderMonkey/JSAPI_reference/JS_EvaluateScript"><code>JS EvaluateScript</code></a> <a href="/ja/docs/Mozilla/Projects/SpiderMonkey/JSAPI_reference/JS_EvaluateScript$translate" style="opacity: 0.5;">[翻訳する]</a></li><li><a href="/ja/docs/Mozilla/Projects/SpiderMonkey/JSAPI_reference/JS_GetRuntime"><code>JS GetRuntime</code></a> <a href="/ja/docs/Mozilla/Projects/SpiderMonkey/JSAPI_reference/JS_GetRuntime$translate" style="opacity: 0.5;">[翻訳する]</a></li><li><a href="/ja/docs/Mozilla/Projects/SpiderMonkey/JSAPI_reference/JS_GetRuntimePrivate"><code>JS GetRuntimePrivate</code></a> <a href="/ja/docs/Mozilla/Projects/SpiderMonkey/JSAPI_reference/JS_GetRuntimePrivate$translate" style="opacity: 0.5;">[翻訳する]</a></li><li><a href="/ja/docs/Mozilla/Projects/SpiderMonkey/JSAPI_reference/JS_NewContext"><code>JS NewContext</code></a> <a href="/ja/docs/Mozilla/Projects/SpiderMonkey/JSAPI_reference/JS_NewContext$translate" style="opacity: 0.5;">[翻訳する]</a></li><li><a href="/ja/docs/Mozilla/Projects/SpiderMonkey/JSAPI_reference/JS_NewRuntime"><code>JS NewRuntime</code></a> <a href="/ja/docs/Mozilla/Projects/SpiderMonkey/JSAPI_reference/JS_NewRuntime$translate" style="opacity: 0.5;">[翻訳する]</a></li><li><a href="/ja/docs/Mozilla/Projects/SpiderMonkey/JSAPI_reference/JS_ShutDown"><code>JS ShutDown</code></a> <a href="/ja/docs/Mozilla/Projects/SpiderMonkey/JSAPI_reference/JS_ShutDown$translate" style="opacity: 0.5;">[翻訳する]</a></li><li><a href="/ja/docs/Mozilla/Projects/SpiderMonkey/JSAPI_reference/JSRuntime"><code>JSRuntime</code></a> <a href="/ja/docs/Mozilla/Projects/SpiderMonkey/JSAPI_reference/JSRuntime$translate" style="opacity: 0.5;">[翻訳する]</a></li><li><a href="/ja/docs/Mozilla/Projects/SpiderMonkey/JSAPI_reference/JSType"><code>JSType</code></a> <a href="/ja/docs/Mozilla/Projects/SpiderMonkey/JSAPI_reference/JSType$translate" style="opacity: 0.5;">[翻訳する]</a></li><li><a href="/ja/docs/Mozilla/Projects/SpiderMonkey/JSAPI_reference/JS_DefineObject"><code>JS_DefineObject</code></a> <a href="/ja/docs/Mozilla/Projects/SpiderMonkey/JSAPI_reference/JS_DefineObject$translate" style="opacity: 0.5;">[翻訳する]</a></li><li><a href="/ja/docs/Mozilla/Projects/SpiderMonkey/JSAPI_reference/JS_Init"><code>JS_Init</code></a> <a href="/ja/docs/Mozilla/Projects/SpiderMonkey/JSAPI_reference/JS_Init$translate" style="opacity: 0.5;">[翻訳する]</a></li><li><a href="/ja/docs/Mozilla/Projects/SpiderMonkey/JSAPI_reference/JS_Lock"><code>JS_Lock</code></a> <a href="/ja/docs/Mozilla/Projects/SpiderMonkey/JSAPI_reference/JS_Lock$translate" style="opacity: 0.5;">[翻訳する]</a></li><li><a href="/ja/docs/Mozilla/Projects/SpiderMonkey/JSAPI_reference/JS_NewObject"><code>JS_NewObject</code></a> <a href="/ja/docs/Mozilla/Projects/SpiderMonkey/JSAPI_reference/JS_NewObject$translate" style="opacity: 0.5;">[翻訳する]</a></li><li><a href="/ja/docs/Mozilla/Projects/SpiderMonkey/JSAPI_reference/jsint"><code>jsint</code></a> <a href="/ja/docs/Mozilla/Projects/SpiderMonkey/JSAPI_reference/jsint$translate" style="opacity: 0.5;">[翻訳する]</a></li></ol>
    </details>
  </li>
  <li class="toggle">
    <details>
      <summary>Debugger-API</summary>

    </details>
  </li>
  <li><strong>Guides:</strong></li>
  <li class="toggle">
    <details>
      <summary>General</summary>
      <ol>
        <li><a href="/ja/docs/Mozilla/Projects/SpiderMonkey/Build_Documentation">Build documentation</a></li>
        <li><a href="/ja/docs/Mozilla/Projects/SpiderMonkey/Introduction_to_the_JavaScript_shell">Introduction to the JavaScript shell</a></li>
        <li><a href="/ja/docs/Mozilla/Projects/SpiderMonkey/JSAPI_User_Guide">JSAPI user guide</a></li>
        <li><a href="/ja/docs/Mozilla/Projects/SpiderMonkey/JSAPI_Cookbook">JSAPI cookbook</a></li>
        <li><a href="/ja/docs/Mozilla/Projects/SpiderMonkey/How_to_embed_the_JavaScript_engine">How to embed the JavaScript engine</a></li>
        <li><a href="/ja/docs/Mozilla/Projects/SpiderMonkey/GC_Rooting_Guide">GC Rooting Guide</a></li>
      </ol>
    </details>
  </li>
  <li class="toggle">
    <details>
      <summary>SpiderMonkey internals</summary>
      <ol><li><a href="/ja/docs/Mozilla/Projects/SpiderMonkey/Internals/Garbage_collection">Garbage collection</a></li><li><a href="/ja/docs/Mozilla/Projects/SpiderMonkey/Internals/Thread_Safety">Thread Safety</a></li><li><a href="/ja/docs/Mozilla/Projects/SpiderMonkey/Internals/Bytecode">バイトコードの説明</a></li></ol>
    </details>
  </li>

  <li><strong>Contributing to SpiderMonkey:</strong></li>
  <li class="toggle">
    <details>
      <summary>Getting started</summary>
      <ol>
        <li><a href="https://wiki.mozilla.org/JavaScript:New_to_SpiderMonkey">New to SpiderMonkey</a></li>
        <li><a href="/ja/docs/Mozilla/Projects/SpiderMonkey/Setting_up_CDT_to_work_on_SpiderMonkey">Setting up CDT to work on SpiderMonkey</a></li>
        <li><a href="/ja/docs/Mozilla/Projects/SpiderMonkey/Hacking_Tips">Hacking tips</a></li>
      </ol>
    </details>
  </li>
  <li class="toggle">
    <details>
      <summary>Tests</summary>
      <ol>
        <li><a href="/ja/docs/Mozilla/Projects/SpiderMonkey/Running_Automated_JavaScript_Tests">Running Automated JavaScript Tests</a></li>
        <li><a href="/ja/docs/Mozilla/Projects/SpiderMonkey/Creating_JavaScript_tests">Creating JavaScript tests</a></li>
        <li><a href="/ja/docs/Mozilla/Projects/SpiderMonkey/Running_Parsemark">Running Parsemark</a></li>
       </ol>
    </details>
  </li>

  <li><strong>Releases:</strong></li>
  <li class="toggle">
    <details>
      <summary>Release notes</summary>
      <ol><li><a href="/ja/docs/Mozilla/Projects/SpiderMonkey/Releases/52">SpiderMonkey 52</a></li></ol>
    </details>
  </li>
  <li><strong><a href="/ja/docs/MDN">Documentation:</a></strong></li>
  <li class="toggle">
    <details>
      <summary>Useful lists</summary>
      <ol>
        <li><a href="/ja/docs/Mozilla/Projects/SpiderMonkey/Index">All pages index</a></li>
        <li><a href="/ja/docs/tag/SpiderMonkey">Pages tagged &quot;SpiderMonkey&quot;</a></li>
      </ol>
    </details>
  </li>
  <li class="toggle">
    <details>
      <summary>Contribute</summary>
      <ol>
        <li><a href="/ja/docs/MDN/Doc_status/SpiderMonkey">SpiderMonkey doc status</a></li>
        <li><a href="/ja/docs/MDN">The MDN project</a></li>
      </ol>
    </details>
  </li>
 </ol>
</section></div>

<div><div class="jsMinVer jsMinVerHeader notecard">
    <p>この記事は <a href="https://developer.mozilla.org/ja/docs/SpiderMonkey/1.8">SpiderMonkey 1.8</a> の新機能について書かれています。</p>
</div></div>

<div class="summary">
<p>GC の活動量、JSAPI アプリケーションの GC 関連のバグを見つけるのに役立つテストおよびデバッグ機能を有効にします。</p>
</div>

<h2 id="Syntax" name="Syntax">構文</h2>

<pre class="brush: cpp">void
JS_SetGCZeal(JSContext *cx, uint8_t zeal, uint32_t frequency);
</pre>

<table class="fullwidth-table">
 <tbody>
  <tr>
   <th>Name</th>
   <th>Type</th>
   <th>Description</th>
  </tr>
  <tr>
   <td><code>cx</code></td>
   <td><a href="/ja/docs/Mozilla/Projects/SpiderMonkey/JSAPI_reference/JSRuntime" title="The documentation about this has not yet been written; please consider contributing!"><code>JSContext *</code></a></td>
   <td>A context. The GC zeal level of the associated <a href="/ja/docs/Mozilla/Projects/SpiderMonkey/JSAPI_reference/JSRuntime" title="The documentation about this has not yet been written; please consider contributing!"><code>JSRuntime</code></a> is set.</td>
  </tr>
  <tr>
   <td><code>zeal</code></td>
   <td><code>uint8_t</code></td>
   <td>The desired level of garbage collection.</td>
  </tr>
  <tr>
   <td><code>frequency</code></td>
   <td><code>uint32_t</code></td>
   <td>With some zeal levels, a GC is triggered every <code>frequency</code> allocations.</td>
  </tr>
 </tbody>
</table>

<h2 id="Description" name="Description">説明</h2>

<p><strong><code>JS_SetGCZeal</code></strong> sets the level of additional garbage collection to perform for a runtime, for the purpose of finding or reproducing bugs.</p>

<p>There are several different levels which have different functions:</p>

<table class="fullwidth-table">
 <thead>
  <tr>
   <th scope="col">Zeal level</th>
   <th scope="col">Description</th>
  </tr>
 </thead>
 <tbody>
  <tr>
   <td>0</td>
   <td>Normal amount of collection.  The default: no additional collections are performed.</td>
  </tr>
  <tr>
   <td>1</td>
   <td>Collect when roots are added or removed.</td>
  </tr>
  <tr>
   <td>2</td>
   <td>Collect when every <code>frequency</code> allocations.</td>
  </tr>
  <tr>
   <td>3</td>
   <td>Collect on window paints.</td>
  </tr>
  <tr>
   <td>4</td>
   <td>Verify pre write barriers between instructions.</td>
  </tr>
  <tr>
   <td>5</td>
   <td>Verify pre write barriers between window paints.</td>
  </tr>
  <tr>
   <td>6</td>
   <td>Verify stack rooting.</td>
  </tr>
  <tr>
   <td>7</td>
   <td>Collect the nursery every <code>frequency</code> nursery allocations.</td>
  </tr>
  <tr>
   <td>8</td>
   <td>Incremental GC in two slices: 1) mark roots 2) finish collection.</td>
  </tr>
  <tr>
   <td>9</td>
   <td>Incremental GC in two slices: 1) mark all 2) new marking and finish.</td>
  </tr>
  <tr>
   <td>10</td>
   <td>Incremental GC in multiple slices.</td>
  </tr>
  <tr>
   <td>11</td>
   <td>Verify post write barriers between instructions.</td>
  </tr>
  <tr>
   <td>12</td>
   <td>Verify post write barriers between paints.</td>
  </tr>
  <tr>
   <td>13</td>
   <td>Check internal hashtables on minor GC.</td>
  </tr>
  <tr>
   <td>14</td>
   <td>Perform a shrinking collection every <code>frequency</code> allocations.</td>
  </tr>
 </tbody>
</table>

<p>With GC zeal enabled, GC-related crashes are much easier to reproduce (they happen more reliably) and debug (they happen sooner, closer to the source of the bug). The drawback is that GC zeal can cause JavaScript code to run extremely slowly.</p>

<p>Regularly running your test suite with GC zeal enabled at level 2 is a good practice.</p>

<p>This function is available only in <code>DEBUG</code> builds. To enable this function in an optimized build, define the macro <code>JS_GC_ZEAL</code> building SpiderMonkey.</p>

<p>(In a debug build of Gecko, you can also set the current GC zeal level using the <code>javascript.options.gczeal</code> preference.)</p>

<h2 id="See_Also" name="See_Also">あわせて参照</h2>

<ul>
 <li><a href="http://mxr.mozilla.org/mozilla-central/ident?i=JS_SetGCZeal">MXR ID で <code>JS_SetGCZeal</code> を</a></li>
 <li><a href="http://mxr.mozilla.org/mozilla-central/ident?i=JS_GC_ZEAL">MXR ID で <code>JS_GC_ZEAL</code> を</a></li>
 <li><a href="/ja/docs/Mozilla/Projects/SpiderMonkey/JSAPI_reference/JS_ScheduleGC" title="The documentation about this has not yet been written; please consider contributing!"><code>JS_ScheduleGC</code></a></li>
 <li><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=308429" title="FIXED: make tooMuchGC dynamic (runtime gczeal option)">バグ 308429</a></li>
 <li><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=650978" title="FIXED: Add gczeal setting to GC on every allocation.">バグ 650978</a></li>
</ul>
