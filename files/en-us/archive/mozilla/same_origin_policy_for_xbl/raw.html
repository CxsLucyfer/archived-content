
<p>The same origin policy used for <a class="internal" href="/En/XBL" title="En/XBL">XBL</a> documents is different from the policy used for other content. This article provides a description of how the same origin policy for XBL works.</p>
<p>When Mozilla needs to decide whether or not XBL is allowed to be loaded, it looks at the <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIPrincipal" title="">nsIPrincipal</a></code> originating the load and the <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIURI" title="">nsIURI</a></code> to be loaded.</p>
<h3 id="Determining_the_originating_principal" name="Determining_the_originating_principal">Determining the originating principal</h3>
<p>The principal originating the load is determined using the following steps:</p>
<ul> <li>For external stylesheets (<code><span class="nowiki">&lt;link&gt;</span></code>, <code><span class="nowiki">&lt;?xml-stylesheet?&gt;</span></code>, user sheets, and UA sheets), it depends on where the sheet is loaded from, just like it would for an HTML document loaded from a similar source.</li> <li>For inline stylesheets (<code><span class="nowiki">&lt;style&gt;</span></code> and style attributes), the principal of the element node involved (meaning the <code><span class="nowiki">&lt;style&gt;</span></code> element or the element whose style attribute is being looked at).</li> <li>For the <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIDOMDocumentXBL" title="">nsIDOMDocumentXBL</a></code> interface's <code><a href="https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/nsIDOMDocumentXBL#addBinding()">nsIDOMDocumentXBL.addBinding()</a></code> and <code><a href="https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/nsIDOMDocumentXBL#loadBindingDocument()">nsIDOMDocumentXBL.loadBindingDocument()</a></code> methods, the originating principal is the one of the script making the call, or the principal of the document the call is made on if there isn't a script.</li>
</ul>
<h3 id="Checks_performed" name="Checks_performed">Checks performed</h3>
<p>Once the originating principal is determined, checks are done to make sure the load should be allowed. The checks performed are:</p>
<ol> <li>If the principal originating the load is the system principal, the load is allowed.</li> <li>A call to <code><a href="/en/CheckLoadURIWithPrincipal" title="en/CheckLoadURIWithPrincipal">ChecLoadURIWithPrincipal()</a></code> is done to make sure the principal is able to link to the given URI in the first place.</li> <li>A content policy check is performed.</li> <li>If the URI is a <code>chrome:</code> URI, the load is allowed. Note that step 2 already denied the load attempt for cases in which the <code>chrome:</code> URI isn't accessible to untrusted content.</li> <li>A <code><a href="/en/CheckMayLoad" title="en/CheckMayLoad">CheckMayLoad()</a></code> check is performed on the originating principal for the given URI.</li>
</ol>
<p>If the <code><a href="/en/CheckMayLoad" title="en/CheckMayLoad">CheckMayLoad()</a></code> check passes, the load is allowed.</p>