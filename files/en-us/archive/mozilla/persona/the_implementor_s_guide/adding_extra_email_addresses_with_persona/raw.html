<p></p><div class="warning">  <p>On November 30th, 2016, Mozilla shut down the persona.org services. Persona.org and related domains will soon be taken offline.</p>  <p>For more information, see this guide to migrating your site away from Persona:</p>  <p><a href="https://wiki.mozilla.org/Identity/Persona_Shutdown_Guidelines_for_Reliers">https://wiki.mozilla.org/Identity/Persona_Shutdown_Guidelines_for_Reliers</a></p></div><p></p>

<p>It's a good idea to allow your users to add extra email addresses to their account. This enables users to <a href="/Persona/The_implementor_s_guide/Enabling_users_to_change_their_email_address">change their email addresses</a>, and to access their account with you even if they are unable to access their primary email account.</p>

<p>You'll need to verify the extra address. You can do this manually, by sending an email to the new address containing a verification link, or by using Persona itself.</p>

<p>If you use Persona to add email addresses, then you need to be aware of a couple of things: make the context of the request clear, and update the value you pass into <code>loggedInUser</code> to ensure that the transaction isn't broken by Persona's session management.</p>

<h3 id="Clarify_the_context_of_the_request">Clarify the context of the request</h3>

<p>When you request a new assertion using with either the old <a href="/en-US/docs/Web/API/Navigator/id/get" title="The documentation about this has not yet been written; please consider contributing!"><code>navigator.id.get()</code></a> API or the <a href="/en-US/docs/Web/API/Navigator/id/request" title="The documentation about this has not yet been written; please consider contributing!"><code>navigator.id.request()</code></a> API, Persona expects that the user is trying to sign into a website, and the user interface it displays reflects that. If you are using Persona just to get a new verified email address, your site needs to make this clear to users, so they are not confused by the Persona dialog.</p>

<h3 id="Update_loggedInUser">Update loggedInUser</h3>

<p>If you're using the <a href="/en-US/docs/Web/API/Navigator/id/get" title="The documentation about this has not yet been written; please consider contributing!"><code>navigator.id.get()</code></a> API in the rest of your site, then you can just make a new <a href="/en-US/docs/Web/API/Navigator/id/get" title="The documentation about this has not yet been written; please consider contributing!"><code>navigator.id.get()</code></a> call to get the extra email address.</p>

<p>But if you use <a href="/en-US/docs/Web/API/Navigator/id/request" title="The documentation about this has not yet been written; please consider contributing!"><code>navigator.id.request()</code></a>, then you must also use <a href="/en-US/docs/Web/API/Navigator/id/request" title="The documentation about this has not yet been written; please consider contributing!"><code>navigator.id.request()</code></a> to get the extra email address. In this case, when you have verified the assertion inside your <code>onlogin</code> handler, you must update the <code>loggedInUser</code> argument to <a href="/en-US/docs/Web/API/Navigator/id/watch" title="The documentation about this has not yet been written; please consider contributing!"><code>navigator.id.watch()</code></a> with the new email address.</p>

<p>If you don't do this, then there will be a mismatch: Persona will think the logged in user is <code>new_emailaddress@example.org</code>, but your website will be telling it that the logged in user is <code>old_emailaddress@example.org</code>. In response, Persona will fire <code>onlogin</code> with an assertion for <code>new_emailaddress@example.org</code>, which your website will probably interpret as a new user signing up.</p>