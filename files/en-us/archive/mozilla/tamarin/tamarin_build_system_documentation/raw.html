<ul> <li><strong>Where can I see the build system status? </strong> <ul> <li>The waterfall page is located at <a class=" external" href="http://tamarin-builds.mozilla.org/tamarin-redux/waterfall" title="http://tamarin-builds.mozilla.org/tamarin-redux/waterfall">http://tamarin-builds.mozilla.org/tamarin-redux/waterfall</a></li> </ul> </li> <li><strong>What builds are displayed on the build system status page? </strong> <ul> <li>tamarin-redux mercurial builds are displayed in the top 3 sections: Compile, Smoke, Test</li> <li>sandbox builds are displayed in next 3 sections: Sandbox Compile, Sandbox Smoke, Sandbox Test</li> <li>tamarin-central is considered a "sandbox" and will appear under Sandbox phase</li> </ul> </li> <li><strong>What are the build phases? </strong> <ul> <li>Compile, Smoke, Test.  When all of the slave machines are free they all start the first build phase simultaneously.  If an error or failure occurs on any slave in a phase the build stops.  The next phase is started when all slaves have completed the previous phase successfully.  </li> <li>The <strong>Compile</strong> phase compiles all of the tamarin source code and builds all of the shell executables, any errors will stop the phase and a red box will appear on the slave where the error occurred.  The compile phase takes about 20-25 minutes.</li> <li>The <strong>Smoke</strong> phase runs a set of tests on each platform until 2 minute is exceeded.  The set of smoke tests can contain any shell build and any test suite (including performance).  The smoke test list is constantly updated to contain the most recent failures, most frequent failures, and the newest testcases.  The idea is to catch test failures in a few minutes rather than running the complete test run (1h 45m).  The smoke test including downloading the shell takes about 3-4 minutes.</li> <li>The <strong>Test</strong> phase runs all functional testcases including acceptance tests, cmdline tests, and selftests.  The acceptance tests are the majority and are run on all shells (release, release-debugger, debug, debug-debugger).  The test phase takes approximately 1 hour 45 minutes.</li> <li>The <strong>Performance</strong> and <span style="font-weight: bold;">D</span><strong>eep</strong> phases do not run synchronously.  The phases run when slaves are available and the other phases do not wait for completion to start the next build.</li> </ul> </li> <li><strong>How are builds triggered? </strong> <ul> <li>checkins (hg push) to <a class=" external" href="http://hg.mozilla.org/tamarin-redux" title="http://hg.mozilla.org/tamarin-redux">http://hg.mozilla.org/tamarin-redux</a> and sandbox requests will trigger a buildbot build</li> <li>When all build slaves are idle the next build begins</li> <li>Before the build begins buildbot waits for 2 minutes of no checkin activity</li> <li>The build system prioritizes tamarin-redux checkins over sandbox builds</li> <li>When several tamarin-redux checkins occur the newest change is built including all checkins since the last build</li> <li>Each sandbox build occurs in the order they were submitted,  The submitter may cancel a build.</li> </ul> </li> <li><strong>How do I build a sandbox build?</strong> <ul> <li>Create a user repository, instructions are <a href="/En/Publishing_Mercurial_Clones" title="https://developer.mozilla.org/En/Publishing_Mercurial_Clones">https://developer.mozilla.org/En/Publishing_Mercurial_Clones</a></li> <li>Go to the request a sandbox build page <a class=" external" href="http://tamarin-builds.mozilla.org/build_trigger/requestbuild.cfm" title="http://tamarin-builds.mozilla.org/build_trigger/requestbuild.cfm">http://tamarin-builds.mozilla.org/build_trigger/requestbuild.cfm</a> <ul> <li>Enter the repository url, revision number, email address, and description.  the description appears in the buildbot status page, please describe what you are trying to build and test</li> </ul> </li> <li>After submitting a sandbox build view the build status page or the queue (if buildbot is busy)</li> </ul> </li> <li><strong>How do I view and change the queue?</strong> <ul> <li>If buildbot is busy the queue is displayed <a class=" external" href="http://tamarin-builds.mozilla.org/build_trigger/requestbuild.cfm" title="http://tamarin-builds.mozilla.org/build_trigger/requestbuild.cfm">http://tamarin-builds.mozilla.org/build_trigger/requestbuild.cfm</a></li> <li>The submitter of a sandbox build may remove a build request by clicking on the Cancel button</li> <li>tamarin-redux builds are higher priority than sandbox builds,  they cannot be removed but the most checkin including all new checkins are built</li> </ul> </li> <li><strong>How can I run buildbot scripts locally?</strong><br> <ul> <li>The buildbot scripts are located in the tamarin repository, get a current copy in your test repository</li> <li>cd into the build/buildbot/slaves directory:  cd build/buildbot/slaves</li> <li>copy the your platform scripts directory into the scripts directory and cd into the new scripts directory:  cp -r mac-intel-10_5/scripts . ; cd scripts</li> <li>edit environment.sh, change the basedir and buildsdir settings <ul> <li>(around line 51) basedir=~/hg/tamarin-redux   (path to my test repository)</li> <li>(next line) buildsdir=~/hg/builds (a directory to store downloaded builds)</li> </ul> </li> <li>always set current working directory to the scripts directory when running a script</li> <li>run a script (e.g.)  ../all/run-acceptance-release.sh &lt;optional hg revision number like 1902&gt;</li> </ul> </li> <li><strong>How do I navigate the build status page?</strong></li> <li> <ul> <li>The page is divided into the phase table at the top and the waterfall table below</li> <li>The phase table shows all phases at the top of the page, each slave is shown as a box with a red,green, or yellow color: red means failed, green passed, and yellow has warnings.</li> <li>The phase state is idle or active</li> <li><span id="1242835277262S" style="display: none;"> </span>Click on the phase (e.g. Compile, Smoke, or Test to show the build slaves from the most recent phase run</li> <li>or Click on an individual box to display the test result</li> <li>Below the phase table the waterfall displays each buildstep and result</li> <li>the left side contains the time column and the user/revision link to represent the revision triggering a build, mouse over the user to see the revision and submission notes</li> <li>Each buildstep run on a slave is a box with color indicating status, red is failed, green passed, yellow has warnings <ul> <li>click the stdio link to see the output</li> <li>click on the Build yellow box at the bottom of a set of buildsteps to see the result of all of the buildsteps for a build and the time each buildstep took</li> </ul> </li> <li>scroll down to see previous builds triggered</li> <li>at the bottom of the page click on the [next page] link to display more previous builds</li> </ul> </li> <li><strong>What are the goals of the build system (QOS)? </strong> <ul> <li>to provide quick and accurate results of building and testing tamarin on supported platforms and configurations</li> <li>to represent the build results in a clear and concise manor</li> <li>Please give use feedback if you have any comments or suggestions to improve the build system</li> </ul> </li> <li><strong>How to add tests to the smokes?</strong> <ul> <li>The list of smoke tests are located in the tamarin-repository, test/run-smokes.txt, assume the start directory is test format is cd testdir; command to run test</li> <li>above the test should be a # comment describing why the test in the smokes, when test failed, possibly a bugzilla bug</li> <li>The tests can be run by following the above instructions for running buildbot scripts locally and executing the all/run-smoke-tests.sh</li> <li>As a rule any test failure should be immediately added to the top of the smoke test list so the list is prioritized</li> </ul> </li> <li><strong>How to exclude tests from acceptance or mark them as known failures? </strong> <ul> <li>The test/acceptance/testconfig.txt file contains a list of tests marked as expected failures or skipped with the configuration</li> <li>see the testconfig.txt for current instructions</li> <li>generally the format is comma separated list with regular expressions for test and configuration.  expectedfail or skip <ul> <li>expectedfail means the test is run and the assertion is the test fails, if the test passes and is marked expectedfail the test result is unexpectedpass and treated like a failure</li> <li>skip means the test is not run, the test may fail intermittently or harm the system altering the results of other tests</li> </ul> </li> </ul> </li>
</ul>