---
title: Exploitable crashes
slug: Mozilla/Security/Exploitable_crashes
tags:
  - Debugging
  - Firefox
  - Guide
  - Mozilla
  - Security
---
<p><span class="seoSummary">This article will help you determine if a crash is exploitable, find crashes which are exploitable, and to fix exploitable crashes.</span></p>
<h2 id="What_is_an_exploitable_crash">What is an exploitable crash?</h2>
<p>A crash report from your debugger, your OS, or <a href="https://crash-stats.mozilla.com/" title="https://crash-stats.mozilla.com/">Mozilla crash-stats</a> can tell you a lot about whether or not a crash is potentially exploitable. You want to look primarily for three things, in order:</p>
<ol>
 <li>Look at the <strong>top frame of the stack trace</strong>. If you see a hex address such as 0x292c2830 rather than a function name such as nsListBoxBodyFrame::GetRowCount at the top of the stack, a bug has caused the program to transfer control to a &quot;random&quot; part of memory that isn&apos;t part of the program. These crashes are almost always exploitable to run arbitrary code.</li>
 <li>Look at the crash reason, which will usually be something like &quot;KERN_PROTECTION_FAILURE (0x0002) at 0x00000000&quot;. This is typically located right above the stack trace. The last number, in this case 0x00000000, is <strong>the memory address Firefox was prevented from accessing</strong>. If the address is always zero (or close to zero, such as 0x0000001c), it&apos;s probably a null dereference bug. These bugs cause the browser to crash, but they do so in a predictable way, so they are not exploitable. Most crashes fall into this category.</li>
 <li>Check the <strong>length of the stack trace</strong>. If it&apos;s over 300 functions long, it&apos;s likely to be a too-much-recursion crash. Like null dereferences, these crashes are not exploitable.</li>
</ol>
<p>Any other crash where Firefox tries to use memory it does not have access to indicates some kind of memory safety bug. These crashes can often be exploited to run arbitrary code, but you can&apos;t be as certain as in the case where you see a bogus address at the top of the stack in step 1.</p>
<h2 id="Finding_exploitable_crashes">Finding exploitable crashes</h2>
<p>Exploitable crashes are most often discovered through normal testing and usage, when developers recognize a crash stack in gdb or submitted to a bug as exploitable.</p>
<p>Additionally, Mozilla developers make heavy use of two tools in particular to find exploitable situations before they show up as exploitable crash reports.</p>
<p>The first tool is <a href="http://www.chromium.org/developers/testing/addresssanitizer" title="http://www.chromium.org/developers/testing/addresssanitizer">AddressSanitizer (ASAN)</a>. There is <a href="https://developer.mozilla.org/en-US/docs/Building_Firefox_with_Address_Sanitizer" title="ASAN with Mozilla Projects">an MDN article</a> documenting its use with Mozilla projects.</p>
<p>The other tool is <a href="http://valgrind.org/" title="http://valgrind.org/">Valgrind</a>. There is <a href="https://developer.mozilla.org/en-US/docs/Debugging_Mozilla_with_Valgrind" title="Valgrind with Mozilla Projects">an MDN article</a> documenting its use with Mozilla projects.</p>
<h2 id="Next_steps">Next steps</h2>
<p>Once you&apos;ve determined that a crash is potentially exploitable, take the following steps. If you need help with any of the steps (e.g. perhaps you lack necessary bugzilla privileges) please email <a href="mailto:security@mozilla.org" title="mailto:security@mozilla.org">security@mozilla.org</a><strong>.</strong></p>
<ol>
 <li>Make sure a bug is on file.</li>
 <li>Mark the bug as security-sensitive by putting it into the &quot;Security-Sensitive Core Bug&quot; group. Do this before making comments or taking actions that expose exploitability publicly.</li>
 <li>Put a <a href="https://wiki.mozilla.org/Security_Severity_Ratings" title="Security Severity Rating">security severity rating</a> in the bug&apos;s keywords. If you&apos;re not sure what rating to give, err on the higher side so the bug will get more attention.</li>
 <li>Explain in a comment why the issue seems exploitable.</li>
</ol>
<h2 id="Other_tools">Other tools</h2>
<p>Apple has a tool called &quot;crashwrangler&quot; that are still being maintained as of 2012. There is little public information about it, and it is hard to find even on the Apple developer site. To get them go to the Mac Developer Center downloads section -&gt; Other Downloads -&gt; search for &quot;crashwrangler&quot;.</p>
<p>Microsoft released a debugger extension tool in 2009 called &quot;!exploitable&quot;. It hasn&apos;t been updated since 2009.</p>
<h2 id="See_also">See also</h2>
<ul>
 <li><a href="http://www.squarefree.com/2006/11/02/determining-whether-a-crash-looks-exploitable/" class="external">Jesse Ruderman&apos;s 2006 blog post on exploitability</a>. This post provided much material for this article.</li>
</ul>
