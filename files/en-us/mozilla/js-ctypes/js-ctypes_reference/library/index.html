---
title: Library
slug: Mozilla/js-ctypes/js-ctypes_reference/Library
tags:
  - JavaScript
  - Reference
  - js-ctypes
---
<section class="Quick_links" id="Quick_Links">
 <ol>
  <li><a href="/en-US/docs/Mozilla/js-ctypes"><strong><em>js-ctypes</em></strong></a></li>
  <li class="toggle">
      <details>
        <summary>Introduction</summary>
        <ol><li><a href="/en-US/docs/Mozilla/js-ctypes/Using_js-ctypes/Debugging_Tips">Debugging Tips</a></li><li><a href="/en-US/docs/Mozilla/js-ctypes/Using_js-ctypes/Declaring_and_calling_functions">Declaring and Calling Functions</a></li><li><a href="/en-US/docs/Mozilla/js-ctypes/Using_js-ctypes/Declaring_and_Using_Callbacks">Declaring and Using Callbacks</a></li><li><a href="/en-US/docs/Mozilla/js-ctypes/Using_js-ctypes/Declaring_types">Declaring types</a></li><li><a href="/en-US/docs/Mozilla/js-ctypes/Using_js-ctypes/Memory_Management">Memory Management</a></li><li><a href="/en-US/docs/Mozilla/js-ctypes/Using_js-ctypes/Standard_OS_Libraries">Standard OS Libraries</a></li><li><a href="/en-US/docs/Mozilla/js-ctypes/Using_js-ctypes/Type_conversion">Type conversion</a></li><li><a href="/en-US/docs/Mozilla/js-ctypes/Using_js-ctypes/Working_with_ArrayBuffers">Working with ArrayBuffers</a></li><li><a href="/en-US/docs/Mozilla/js-ctypes/Using_js-ctypes/Working_with_data">Working with data</a></li><li><a href="/en-US/docs/Mozilla/js-ctypes/Using_js-ctypes/ctypes.open">ctypes.open</a></li></ol>
      </details>
  </li>
  <li class="toggle">
      <details open>
        <summary>References</summary>
        <ol><li><a href="/en-US/docs/Mozilla/js-ctypes/js-ctypes_reference/ABI"><code>ABI</code></a></li><li><a href="/en-US/docs/Mozilla/js-ctypes/js-ctypes_reference/ArrayType"><code>ArrayType</code></a></li><li><a href="/en-US/docs/Mozilla/js-ctypes/js-ctypes_reference/CData"><code>CData</code></a></li><li><a href="/en-US/docs/Mozilla/js-ctypes/js-ctypes_reference/CType"><code>CType</code></a></li><li><a href="/en-US/docs/Mozilla/js-ctypes/js-ctypes_reference/FunctionType"><code>FunctionType</code></a></li><li><a href="/en-US/docs/Mozilla/js-ctypes/js-ctypes_reference/Int64"><code>Int64</code></a></li><li><a href="/en-US/docs/Mozilla/js-ctypes/js-ctypes_reference/Library"><code>Library</code></a></li><li><a href="/en-US/docs/Mozilla/js-ctypes/js-ctypes_reference/PointerType"><code>PointerType</code></a></li><li><a href="/en-US/docs/Mozilla/js-ctypes/js-ctypes_reference/StructType"><code>StructType</code></a></li><li><a href="/en-US/docs/Mozilla/js-ctypes/js-ctypes_reference/UInt64"><code>UInt64</code></a></li><li><a href="/en-US/docs/Mozilla/js-ctypes/js-ctypes_reference/ctypes"><code>ctypes</code></a></li></ol>
      </details>
  </li>
  <li class="toggle">
      <details>
        <summary>Examples</summary>
        <ol><li><a href="/en-US/docs/Mozilla/js-ctypes/Examples/Add_to_iPhoto">Add to iPhoto</a></li><li><a href="/en-US/docs/Mozilla/js-ctypes/Examples/Using_C_structs_and_pointers">Using C struct and pointers</a></li><li><a href="/en-US/docs/Mozilla/js-ctypes/Examples/Using_COM_from_js-ctypes">Using COM from js-ctypes</a></li><li><a href="/en-US/docs/Mozilla/js-ctypes/Examples/Using_Objective-C_from_js-ctypes">Using Objective-C from js-ctypes</a></li></ol>
      </details>
  </li>
 </ol>
</section>



<div class="draft notecard">
    <p><strong>Draft</strong><br>
    This page is not complete.</p>

</div>

<p>The <code>Library</code> object represents a native library loaded by the ctypes <a href="/en-US/docs/Mozilla/js-ctypes/js-ctypes_reference/ctypes#open()" title="The ctypes object contains methods and predefined data types used to create and manage a library."><code>open()</code></a> method. Its methods let you declare symbols exported by the library, and to manage the library.</p>

<h2 id="Method_overview">Method overview</h2>

<table class="standard-table">
 <tbody>
  <tr>
   <td><code><a href="#close()">close</a>();</code></td>
  </tr>
  <tr>
   <td><code><a href="/en-US/docs/Mozilla/js-ctypes/js-ctypes_reference/CData" title="A CData object represents a C value or function located in memory."><code>CData</code></a> <a href="#declare()">declare</a>(name, [abi, ], returnType[, argType1, ...])</code>;</td>
  </tr>
 </tbody>
</table>

<h2 id="Methods">Methods</h2>

<h3 id="eatCookie.28.29" name="eatCookie.28.29">close()</h3>

<p>Closes the library. You need to call this once you&apos;re done using the library.</p>

<pre class="eval">close();
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<p>None.</p>

<h3 id="declare">declare()</h3>

<p>Declares an API from the native library, allowing it to be used from JavaScript. This can be used both for exported data symbols and for functions.</p>

<pre class="eval">CData declare(
  name[,
  abi,
  returnType
  argType1,
  ...]
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>name</code></dt>
 <dd>The name of the symbol exported by the native library that is to be declared as usable from JavaScript</dd>
 <dt><code>abi</code></dt>
 <dd>The <a href="/en-US/docs/Mozilla/js-ctypes/js-ctypes_reference/ABI" title="This article describes the calling conventions with respect to js-ctypes while programming x86 and x86-64/x64/AMD64 architectures. A calling convention is an implementation-level (low-level) scheme regarding how subroutines receive parameters from their caller and how they revert."><code>ABI</code></a> used by the exported function; this will be <code>ctypes.default_abi</code> for most libraries, except for Windows libraries, which will be <code>ctypes.winapi_abi</code> or <code>ctypes.stdcall_abi</code>. See <a href="/en-US/docs/Mozilla/js-ctypes/js-ctypes_reference/ctypes#ABI_constants" title="The ctypes object contains methods and predefined data types used to create and manage a library.">ABI constants</a>. You don&apos;t need to provide this for exported data; it&apos;s only needed for function declarations.</dd>
 <dt><code>returnType</code></dt>
 <dd>The <a href="/en-US/docs/Mozilla/js-ctypes/js-ctypes_reference/CType" title="All data types declared using the js-ctypes API are represented by CType objects. These objects have assorted methods and properties that let you create objects of these types, find out information about them, and so forth. The specific properties and methods on each object vary depending on the data type represented."><code>CType</code></a> type returned by the defined API, if it&apos;s a function. This parameter should not be provided if the API is an exported data symbol.</dd>
 <dt><code>argType1...argTypeN</code></dt>
 <dd>Zero or more parameter <a href="/en-US/docs/Mozilla/js-ctypes/js-ctypes_reference/CType" title="All data types declared using the js-ctypes API are represented by CType objects. These objects have assorted methods and properties that let you create objects of these types, find out information about them, and so forth. The specific properties and methods on each object vary depending on the data type represented."><code>CType</code></a> may be specified for the parameters of the function being declared. These should not be provided if the API is an exported data symbol rather than a function.</dd>
</dl>

<h6 id="Return_value">Return value</h6>

<p>A <a href="/en-US/docs/Mozilla/js-ctypes/js-ctypes_reference/FunctionType" title="The documentation about this has not yet been written; please consider contributing!"><code>FunctionType</code></a> <a href="/en-US/docs/Mozilla/js-ctypes/js-ctypes_reference/CData" title="A CData object represents a C value or function located in memory."><code>CData</code></a> object representing the declared API.</p>

<h6 id="Exceptions_thrown">Exceptions thrown</h6>

<ul>
 <li><a href="/en-US/docs/Mozilla/js-ctypes/js-ctypes_reference/ctypes" title="The ctypes object contains methods and predefined data types used to create and manage a library."><code>ctypes</code></a></li>
 <li><a href="/en-US/docs/Mozilla/js-ctypes/js-ctypes_reference/CType" title="All data types declared using the js-ctypes API are represented by CType objects. These objects have assorted methods and properties that let you create objects of these types, find out information about them, and so forth. The specific properties and methods on each object vary depending on the data type represented."><code>CType</code></a></li>
 <li><a href="/en-US/docs/Mozilla/js-ctypes/js-ctypes_reference/FunctionType" title="The documentation about this has not yet been written; please consider contributing!"><code>FunctionType</code></a></li>
 <li><a href="/en-US/docs/Mozilla/js-ctypes/js-ctypes_reference/ABI" title="This article describes the calling conventions with respect to js-ctypes while programming x86 and x86-64/x64/AMD64 architectures. A calling convention is an implementation-level (low-level) scheme regarding how subroutines receive parameters from their caller and how they revert."><code>ABI</code></a></li>
</ul>

<dl>
 <dt><a href="/en-US/docs/Web/JavaScript/Reference/Global_Objects/TypeError" title="The TypeError object represents an error when a value is not of the expected type."><code>TypeError</code></a></dt>
 <dd>The return type was specified as an array.</dd>
</dl>

<h2 id="Alternative_Syntax">Alternative Syntax</h2>

<p>Another use for ctypes.declare is to get non-function/non-methods from libraries. The syntax for this is seen in Firefox codebase here:</p>

<p><a href="https://dxr.mozilla.org/mozilla-central/source/js/src/ctypes/Library.cpp?offset=0#271">https://dxr.mozilla.org/mozilla-central/source/js/src/ctypes/Library.cpp?offset=0#271</a></p>

<p>This shows that we can also supply only two arguments to the declare function. The first being the same as in the above example, name, which is the name of the symbol to export. And in place of the abi argument, we will pass in the type of this export. For example, from the Objective-C library we can export the symbol which holds the address to an external block. This would be done like this:</p>

<pre class="brush: js">var objc = ctypes.open(ctypes.<span class="pl-c1">libraryName</span>(<span class="pl-s"><span class="pl-pds">&apos;</span>objc<span class="pl-pds">&apos;</span></span>));

objc.<span class="pl-c1">declare</span>(<span class="pl-s"><span class="pl-pds">&apos;</span>_NSConcreteGlobalBlock<span class="pl-pds">&apos;</span></span>, ctypes.<span class="pl-c1">voidptr_t</span>);</pre>

<dl>
 <dt>
 <h2 id="See_Also">See Also</h2>
 </dt>
</dl>
