---
title: Mozmill Base Object Interfaces
slug: Mozilla/Projects/Mozmill/Mozmill_Base_Object_Interfaces
tags:
  - MozMill
---
<p>At the top of many Mozmill tests you will see a line that contains a setupModule function with something that looks like the following code in it: controller = mozmill.getBrowserController(); This creates a &quot;controller&quot; object for the test to use. The <a href="/en-US/docs/Mozmill/Mozmill_Controller_Object" title="en/Mozmill/Mozmill_Controller_Object">controller object</a> is the heart of all Mozmill interfaces in that it allows you to completely control the application under test. However, this makes use of a global object called mozmill to instantiate the controller. The mozmill object API provides many convenience methods to help you get started testing specific applications.</p>
<h2 id="Method_overview">Method overview</h2>
<table class="standard-table">
  <tbody>
    <tr>
      <td><code><a href="/en-US/docs/Mozmill/Mozmill_Controller_Object">controller</a> <a href="#getBrowserController()">getBrowserController</a>();</code></td>
    </tr>
    <tr>
      <td><code><a href="/en-US/docs/Mozmill/Mozmill_Controller_Object">controller</a> <a href="#newBrowserController()">newBrowserController</a>();</code></td>
    </tr>
    <tr>
      <td><code><a href="/en-US/docs/Mozmill/Mozmill_Controller_Object">controller</a> <a href="#getDownloadsController()">getDownloadsController</a>();</code></td>
    </tr>
    <tr>
      <td><code><a href="/en-US/docs/Mozmill/Mozmill_Controller_Object">controller</a> <a href="#getAddrbkController()">getAddrbkController</a>();</code></td>
    </tr>
    <tr>
      <td><code><a href="/en-US/docs/Mozmill/Mozmill_Controller_Object">controller</a> <a href="#newAddrbkController()">newAddrbkController</a>();</code></td>
    </tr>
    <tr>
      <td><code><a href="/en-US/docs/Mozmill/Mozmill_Controller_Object">controller</a> <a href="#getMail3PaneController()">getMail3PaneController</a>();</code></td>
    </tr>
    <tr>
      <td><code><a href="/en-US/docs/Mozmill/Mozmill_Controller_Object">controller</a> <a href="#newMail3PaneController()">newMail3PaneController</a>();</code></td>
    </tr>
    <tr>
      <td><code><a href="/en-US/docs/Mozmill/Mozmill_Controller_Object">controller</a> <a href="#getAddonsController()">getAddonsController</a>();</code></td>
    </tr>
    <tr>
      <td><code><a href="/en-US/docs/Mozmill/Mozmill_Controller_Object">controller</a> <a href="#getPreferencesController()">getPreferencesController</a>();</code></td>
    </tr>
    <tr>
      <td><code><a href="/en-US/docs/Mozmill/Mozmill_Controller_Object">controller</a> <a href="#controller.MozmillController()">controller.MozmillController</a>();</code></td>
    </tr>
  </tbody>
</table>
<h2 id="Attributes">Attributes</h2>
<table class="standard-table">
  <thead>
    <tr>
      <th scope="col">Attribute</th>
      <th scope="col">Type</th>
      <th scope="col">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>platform</code></td>
      <td>object</td>
      <td>The name of the platform according to the Gecko subsystem, i.e. Mac == Darwin, Windows == winnt, linux == linux. For more specifc testing use the &quot;is&quot; attributes below.</td>
    </tr>
    <tr>
      <td><code>isWindows</code></td>
      <td>boolean</td>
      <td>True if the current platform is a Windows operating system</td>
    </tr>
    <tr>
      <td><code>isLinux</code></td>
      <td>boolean</td>
      <td>True if the current platform is a Linux operating system</td>
    </tr>
    <tr>
      <td><code>isMac</code></td>
      <td>boolean</td>
      <td>True if the current platform is a Mac OS X operating system</td>
    </tr>
    <tr>
      <td><code>wm</code></td>
      <td><code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIWindowMediator">nsIWindowMediator</a></code></td>
      <td>Shortcut to the nsIWindowsMediator service, for an example of use see controller.MozMillController below</td>
    </tr>
    <tr>
      <td><code>appInfo</code></td>
      <td><code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIXULAppInfo">nsIXULAppInfo</a></code></td>
      <td>Shortcut to the nsIXULAppInfo service.</td>
    </tr>
  </tbody>
</table>
<h2 id="Browser_Methods">Browser Methods</h2>
<h3 id="getBrowserController()" name="getBrowserController()">getBrowserController()</h3>
<p>Gets a new browser controller for the currently open browser window. If no window is open, it opens a new window and returns a controller for that. <em>Supported in Firefox and Seamonkey</em>.</p>
<pre>controller getBrowserController();
</pre>
<h6 id="Parameters">Parameters</h6>
<p>None</p>
<h6 id="Return_value">Return value</h6>
<p><code>controller</code> Returns a <a href="/en-US/docs/Mozmill/Mozmill_Controller_Object" title="en/Mozmill/Mozmill_Controller_Object">controller object</a> for the window.</p>
<h6 id="Example">Example</h6>
<pre class="brush: js">controller = mozmill.getBrowserController();
</pre>
<h3 id="newBrowserController()" name="newBrowserController()">newBrowserController()</h3>
<p>Forces creation of a new browser window and returns a controller for it, regardless of how many other browser windows are open. <em>Supported in Firefox and Seamonkey</em>.</p>
<pre>controller newBrowserController();
</pre>
<h6 id="Parameters_2">Parameters</h6>
<p>None</p>
<h6 id="Return_value_2">Return value</h6>
<p><code>controller</code> Returns a <a href="/en-US/docs/Mozmill/Mozmill_Controller_Object" title="en/Mozmill/Mozmill_Controller_Object">controller object</a> for the window.</p>
<h6 id="Example_2">Example</h6>
<pre class="brush: js">controller = mozmill.newBrowserController();
</pre>
<h3 id="getDownlaodsController()" name="getDownlaodsController()">getDownloadsController()</h3>
<p>Instantiates the Downloads window and returns a controller for that or returns a controller to an already opened Downloads window. <em>Supported in Firefox and Seamonkey</em>.</p>
<pre>controller getDownloadsController();
</pre>
<h6 id="Parameters_3">Parameters</h6>
<p>None</p>
<h6 id="Return_value_3">Return value</h6>
<p><code>controller</code> Returns a <a href="/en-US/docs/Mozmill/Mozmill_Controller_Object" title="en/Mozmill/Mozmill_Controller_Object">controller object</a> for the window.</p>
<h6 id="Example_3">Example</h6>
<pre class="brush: js">controller = mozmill.getDownloadsController();
</pre>
<h2 id="Mail_Methods">Mail Methods</h2>
<h3 id="getAddrbkController()" name="getAddrbkController()">getAddrbkController()</h3>
<p>Gets a controller for the current Thunderbird Addressbook window. If one is not open, it opens a window and returns a controller for that. <em>Supported in Thunderbird</em>.</p>
<pre>controller getAddrbkController();
</pre>
<h6 id="Parameters_4">Parameters</h6>
<p>None</p>
<h6 id="Return_value_4">Return value</h6>
<p><code>controller</code> Returns a <a href="/en-US/docs/Mozmill/Mozmill_Controller_Object" title="en/Mozmill/Mozmill_Controller_Object">controller object</a> for the window.</p>
<h6 id="Example_4">Example</h6>
<pre class="brush: js">controller = mozmill.getAddrbkController();
</pre>
<h3 id="newAddrbkController()" name="newAddrbkController()">newAddrbkController()</h3>
<p>Forces the system to create a new addressbook window and returns a controller for that. <em>Supported in Thunderbird.</em></p>
<pre>controller newAddrbkController();
</pre>
<h6 id="Parameters_5">Parameters</h6>
<p>None</p>
<h6 id="Return_value_5">Return value</h6>
<p><code>controller</code> Returns a <a href="/en-US/docs/Mozmill/Mozmill_Controller_Object" title="en/Mozmill/Mozmill_Controller_Object">controller object</a> for the window.</p>
<h6 id="Example_5">Example</h6>
<pre class="brush: js">controller = mozmill.newAddrbkController();
</pre>
<h3 class="editable" id="getMail3PaneController()"><span>getMail3PaneController</span>()</h3>
<p>Gets a controller for the current Thunderbird window. If one is not open, it opens a window and returns a controller for that. <em>Supported in Thunderbird</em>.</p>
<pre>controller getMail3PaneController();
</pre>
<h6 id="Parameters_6">Parameters</h6>
<p>None</p>
<h6 id="Return_value_6">Return value</h6>
<p><code>controller</code> Returns a <a href="/en-US/docs/Mozmill/Mozmill_Controller_Object" title="en/Mozmill/Mozmill_Controller_Object">controller object</a> for the window.</p>
<h6 id="Example_6">Example</h6>
<pre class="brush: js">controller = mozmill.getMail3PaneController();
</pre>
<h3 id="newAddrbkController()" name="newAddrbkController()">newMail3PaneController()</h3>
<p>Forces the system to create a new main Thunderbird window and returns a controller for that. <em>Supported in Thunderbird</em>.</p>
<pre>controller newMail3PaneController();
</pre>
<h6 id="Parameters_7">Parameters</h6>
<p>None</p>
<h6 id="Return_value_7">Return value</h6>
<p><code>controller</code> Returns a <a href="/en-US/docs/Mozmill/Mozmill_Controller_Object" title="en/Mozmill/Mozmill_Controller_Object">controller object</a> for the window.</p>
<h6 id="Example_7">Example</h6>
<pre class="brush: js">controller = mozmill.newMail3PaneController();
</pre>
<h2 id="General_Methods">General Methods</h2>
<h3 id="getAddonsController()" name="getAddonsController()">getAddonsController()</h3>
<p>Creates a controller for the currently open Add-Ons window, if one is not open, it opens one and returns the controller for that. Supported in all applications that use the toolkit Extension Manager to manage addons.</p>
<pre>controller getAddonsController();
</pre>
<h6 id="Parameters_8">Parameters</h6>
<p>None</p>
<h6 id="Return_value_8">Return value</h6>
<p><code>controller</code> Returns a <a href="/en-US/docs/Mozmill/Mozmill_Controller_Object" title="en/Mozmill/Mozmill_Controller_Object">controller object</a> for the window.</p>
<h6 id="Example_8">Example</h6>
<pre class="brush: js">controller = mozmill.getAddonsController();
</pre>
<h3 id="getPreferencesController()" name="getPreferencesController()">getPreferencesController()</h3>
<p>Creates a controller for the currently open Preferences window, if one is not open, it opens one and returns the controller for that. Supported in all applications.</p>
<pre>controller getPreferencesController();
</pre>
<h6 id="Parameters_9">Parameters</h6>
<p>None</p>
<h6 id="Return_value_9">Return value</h6>
<p><code>controller</code> Returns a <a href="/en-US/docs/Mozmill/Mozmill_Controller_Object" title="en/Mozmill/Mozmill_Controller_Object">controller object</a> for the window.</p>
<h6 id="Example_9">Example</h6>
<pre class="brush: js">controller = mozmill.getPreferencesController();
</pre>
<h3 id="controller.MozMillController()" name="controller.MozMillController()">controller.MozMillController()</h3>
<p>Creates a controller for the given window. This works on all supported applications and allows you to create controllers for windows that do not have a convenience method above. Supported in all applications.</p>
<pre>controller controller.MozMillController(in <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIDOMWindow" title>nsIDOMWindow</a></code> window);
</pre>
<h6 id="Parameters_10">Parameters</h6>
<dl>
  <dt>
    <code>window</code></dt>
  <dd>
    The DOM Window you wish to wrap into a controller object</dd>
</dl>
<h6 id="Return_value_10">Return value</h6>
<p><code>controller</code> Returns a <a href="/en-US/docs/Mozmill/Mozmill_Controller_Object" title="en/Mozmill/Mozmill_Controller_Object">controller object</a> for the window.</p>
<h6 id="Example_10">Example</h6>
<pre class="brush: js">// Creates a controller for the browser&apos;s page information dialog.
// It assumes that you&apos;ve already clicked on the proper icons to launch the dialog.
let window = mozmill.wm.getMostRecentWindow(&apos;Browser:page-info&apos;);
let pageInfoController = new mozmill.controller.MozMillController(window);
</pre>
