---
title: nsIMsgSearchSession
slug: Mozilla/Tech/XPCOM/Reference/Interface/nsIMsgSearchSession
tags:
  - Interfaces
  - 'Interfaces:Scriptable'
  - NeedsContent
  - XPCOM Interface Reference
  - thunderbird
---
<p>The <code>nsIMsgSearchSession</code> interface allows you to create and manipulate search sessions within <a href="/en/Thunderbird" title="en/Thunderbird">Thunderbird</a>.</p>

<p>To create an instance, use:</p>

<pre class="eval"> var searchSession = Components.classes[&quot;@mozilla.org/messenger/searchSession;1&quot;]
                               .createInstance(Components.interfaces.nsIMsgSearchSession);
</pre>

<p>To use the instance append search terms, set the scope, and then call <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIMsgSearchSession#search()">search()</a></code>.</p>

<pre class="brush: js">searchSession.addScopeTerm(Components.interfaces.nsMsgSearchScope.offlineMail, aFolder);
var searchTerm = searchSession.createTerm();
var value = searchTerm.value;
value.str = aValue;
searchTerm.value = value;

searchTerm.op = searchSession.BooleanOR;
searchTerm.booleanAnd = false;

searchSession.appendTerm(searchTerm);
searchSession.search(null);</pre>

<p>Inherits from: <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsISupports" title>nsISupports</a></code></p>

<h2 id="Method_overview" name="Method_overview">Method overview</h2>

<table class="standard-table">
 <tbody>
  <tr>
   <td><code>void <a href="#addSearchTerm">addSearchTerm</a>(in <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsMsgSearchAttribValue">nsMsgSearchAttribValue</a></code> attrib, in <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsMsgSearchOpValue">nsMsgSearchOpValue</a></code> op, in <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIMsgSearchValue">nsIMsgSearchValue</a></code> value, in boolean BooleanAND, in string arbitraryHeader);</code></td>
  </tr>
  <tr>
   <td><code><code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIMsgSearchTerm">nsIMsgSearchTerm</a></code> <a href="#createTerm">createTerm</a>();</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#appendTerm">appendTerm</a>(in <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIMsgSearchTerm">nsIMsgSearchTerm</a></code> term);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#registerListener">registerListener</a>(in <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIMsgSearchNotify">nsIMsgSearchNotify</a></code> listener);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#unregisterListener">unregisterListener</a>(in <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIMsgSearchNotify">nsIMsgSearchNotify</a></code> listener);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#getNthSearchTerm">getNthSearchTerm</a>(in long whichTerm, in <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsMsgSearchAttribValue">nsMsgSearchAttribValue</a></code> attrib, in <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsMsgSearchOpValue">nsMsgSearchOpValue</a></code> op, in <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIMsgSearchValue">nsIMsgSearchValue</a></code> value);</code></td>
  </tr>
  <tr>
   <td><code>long <a href="#countSearchScopes">countSearchScopes</a>();</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#getNthSearchScope">getNthSearchScope</a>(in long which,out <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsMsgSearchScopeValue">nsMsgSearchScopeValue</a></code> scopeId, out <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIMsgFolder">nsIMsgFolder</a></code> folder);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#addScopeTerm">addScopeTerm</a>(in <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsMsgSearchScopeValue">nsMsgSearchScopeValue</a></code> scope, in <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIMsgFolder">nsIMsgFolder</a></code> folder);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#addDirectoryScopeTerm">addDirectoryScopeTerm</a>(in <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsMsgSearchScopeValue">nsMsgSearchScopeValue</a></code> scope); </code></td>
  </tr>
  <tr>
   <td><code>void <a href="#clearScopes">clearScopes</a>();</code></td>
  </tr>
  <tr>
   <td><code>[noscript] boolean <a href="#ScopeUsesCustomHeaders">ScopeUsesCustomHeaders</a>(in <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsMsgSearchScopeValue">nsMsgSearchScopeValue</a></code> scope, in voidPtr selection, in boolean forFilters);</code></td>
  </tr>
  <tr>
   <td><code>boolean <a href="#IsStringAttribute">IsStringAttribute</a>(in <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsMsgSearchAttribValue">nsMsgSearchAttribValue</a></code> attrib);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#AddAllScopes">AddAllScopes</a>(in <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsMsgSearchScopeValue">nsMsgSearchScopeValue</a></code> attrib);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#search">search</a>(in nsIMsgWindow aWindow);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#interruptSearch">interruptSearch</a>();</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#pauseSearch">pauseSearch</a>();</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#resumeSearch">resumeSearch</a>();</code></td>
  </tr>
  <tr>
   <td><code>[noscript] <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsMsgSearchType">nsMsgSearchType</a></code> <a href="#SetSearchParam">SetSearchParam</a>(in <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsMsgSearchType">nsMsgSearchType</a></code> type, in voidPtr param);</code></td>
  </tr>
  <tr>
   <td><code>[noscript] void <a href="#AddResultElement">AddResultElement</a>(in <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsMsgResultElement">nsMsgResultElement</a></code> element);</code></td>
  </tr>
  <tr>
   <td><code>boolean <a href="#MatchHdr">MatchHdr</a>(in <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIMsgDBHdr">nsIMsgDBHdr</a></code> aMsgHdr, in <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIMsgDatabase">nsIMsgDatabase</a></code> aDatabase);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#addSearchHit">addSearchHit</a>(in <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIMsgDBHdr">nsIMsgDBHdr</a></code> header, in <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIMsgFolder">nsIMsgFolder</a></code> folder);</code></td>
  </tr>
 </tbody>
</table>

<h2 id="Attributes" name="Attributes">Attributes</h2>

<table class="standard-table">
 <tbody>
  <tr>
   <td class="header">Attribute</td>
   <td class="header">Type</td>
   <td class="header">Description</td>
  </tr>
  <tr>
   <td><code>searchTerms</code></td>
   <td><code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsISupportsArray">nsISupportsArray</a></code></td>
   <td><strong>Readonly: </strong></td>
  </tr>
  <tr>
   <td><code>numSearchTerms</code></td>
   <td>unsigned long</td>
   <td><strong>Readonly: </strong></td>
  </tr>
  <tr>
   <td><code>runningAdapter</code></td>
   <td><code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIMsgSearchAdapter">nsIMsgSearchAdapter</a></code></td>
   <td><strong>Readonly: </strong></td>
  </tr>
  <tr>
   <td><code>searchParam</code></td>
   <td>voidPtr</td>
   <td><strong>Not scriptable and readonly: </strong></td>
  </tr>
  <tr>
   <td><code>searchType</code></td>
   <td><code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsMsgSearchType">nsMsgSearchType</a></code></td>
   <td><strong>Readonly: </strong></td>
  </tr>
  <tr>
   <td><code>numResults</code></td>
   <td>long</td>
   <td><strong>Readonly: </strong></td>
  </tr>
  <tr>
   <td><code>window</code></td>
   <td><code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIMsgWindow">nsIMsgWindow</a></code></td>
   <td> </td>
  </tr>
 </tbody>
</table>

<h2 id="Constants" name="Constants">Constants</h2>

<table class="standard-table">
 <tbody>
  <tr>
   <td class="header">Name</td>
   <td class="header">Value</td>
   <td class="header">Description</td>
  </tr>
  <tr>
   <td><code>BooleanOR</code></td>
   <td>0</td>
   <td> </td>
  </tr>
  <tr>
   <td><code>BooleanAND</code></td>
   <td>1</td>
   <td> </td>
  </tr>
 </tbody>
</table>

<h2 id="Methods" name="Methods">Methods</h2>

<h3 id="addSearchTerm.28.29" name="addSearchTerm.28.29">addSearchTerm()</h3>

<pre class="eval"> void addSearchTerm(in <a href="/en/XPCOM_Interface_Reference/nsMsgSearchAttribValue" title="nsMsgSearchAttribValue">nsMsgSearchAttribValue</a> attrib,
                    in <a href="/nsMsgSearchOpValue" title="nsMsgSearchOpValue">nsMsgSearchOpValue</a> op,
                    in <a href="/nsIMsgSearchValue" title="nsIMsgSearchValue">nsIMsgSearchValue</a> value,
                    in boolean BooleanAND,
                    in string arbitraryHeader);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>attrib</code></dt>
 <dd>Attribute for this term.</dd>
 <dt><code>op</code></dt>
 <dd>Operator e.g. opContains</dd>
 <dt><code>value</code></dt>
 <dd>Value e.g. &quot;Dogbert&quot;</dd>
 <dt><code>BooleanAND</code></dt>
 <dd>Set to <code>true</code> if associated boolean operator is <code>AND</code>.</dd>
 <dt><code>arbitraryHeader</code></dt>
 <dd>User defined arbitrary header. Ignored unless <code>attrib = attribOtherHeader</code>.</dd>
</dl>

<h3 id="createTerm.28.29" name="createTerm.28.29">createTerm()</h3>

<pre class="eval"> nsIMsgSearchTerm createTerm();
</pre>

<h3 id="appendTerm.28.29" name="appendTerm.28.29">appendTerm()</h3>

<pre class="eval"> void appendTerm(in nsIMsgSearchTerm term);
</pre>

<h6 id="Parameters_2" name="Parameters_2">Parameters</h6>

<dl>
 <dt><code>term</code></dt>
 <dd> </dd>
</dl>

<h3 id="registerListener.28.29" name="registerListener.28.29">registerListener()</h3>

<p>Adds a listener to the search session.</p>

<pre class="eval"> void registerListener(in nsIMsgSearchNotify listener);
</pre>

<h6 id="Parameters_3" name="Parameters_3">Parameters</h6>

<dl>
 <dt><code>listener</code></dt>
 <dd> </dd>
</dl>

<h3 id="unregisterListener.28.29" name="unregisterListener.28.29">unregisterListener()</h3>

<p>Removes a listener from the search session.</p>

<pre class="eval"> void unregisterListener (in nsIMsgSearchNotify listener);
</pre>

<h6 id="Parameters_4" name="Parameters_4">Parameters</h6>

<dl>
 <dt><code>listener</code></dt>
 <dd> </dd>
</dl>

<h3 id="getNthSearchTerm.28.29" name="getNthSearchTerm.28.29">getNthSearchTerm()</h3>

<pre class="eval"> void getNthSearchTerm(in long whichTerm,
                       in nsMsgSearchAttribValue attrib,
                       in nsMsgSearchOpValue op,
</pre>

<p>in nsIMsgSearchValue value);</p>

<h6 id="Parameters_5" name="Parameters_5">Parameters</h6>

<dl>
 <dt><code>whichTerm</code></dt>
 <dd> </dd>
 <dt><code>attrib</code></dt>
 <dd> </dd>
 <dt><code>op</code></dt>
 <dd> </dd>
 <dt><code>value</code></dt>
 <dd><div class="note notecard"><strong>Note:</strong> This parameter should be an <code>out</code>.</div></dd>
</dl>

<h3 id="countSearchScopes.28.29" name="countSearchScopes.28.29">countSearchScopes()</h3>

<pre class="eval"> long countSearchScopes();
</pre>

<h3 id="getNthSearchScope.28.29" name="getNthSearchScope.28.29">getNthSearchScope()</h3>

<pre class="eval"> void getNthSearchScope(in long which,
                        out nsMsgSearchScopeValue scopeId,
                        out nsIMsgFolder folder);
</pre>

<h6 id="Parameters_6" name="Parameters_6">Parameters</h6>

<dl>
 <dt><code>which</code></dt>
 <dd> </dd>
</dl>

<h6 id="Return_values" name="Return_values">Return values</h6>

<dl>
 <dt><code>scopeId</code></dt>
 <dd> </dd>
 <dt><code>folder</code></dt>
 <dd> </dd>
</dl>

<h3 id="addScopeTerm.28.29" name="addScopeTerm.28.29">addScopeTerm()</h3>

<p>Add a scope (e.g. a mail folder) to the search.</p>

<pre class="eval"> void addScopeTerm(in nsMsgSearchScopeValue scope,
                   in nsIMsgFolder folder);
</pre>

<h6 id="Parameters_7" name="Parameters_7">Parameters</h6>

<dl>
 <dt><code>scope</code></dt>
 <dd> </dd>
 <dt><code>folder</code></dt>
 <dd> </dd>
</dl>

<h3 id="addDirectoryScopeTerm.28.29" name="addDirectoryScopeTerm.28.29">addDirectoryScopeTerm()</h3>

<pre class="eval"> void addDirectoryScopeTerm(in nsMsgSearchScopeValue scope);
</pre>

<h6 id="Parameters_8" name="Parameters_8">Parameters</h6>

<dl>
 <dt><code>scope</code></dt>
 <dd> </dd>
</dl>

<h3 id="clearScopes.28.29" name="clearScopes.28.29">clearScopes()</h3>

<pre class="eval"> void clearScopes();
</pre>

<h3 id="ScopeUsesCustomHeaders.28.29" name="ScopeUsesCustomHeaders.28.29">ScopeUsesCustomHeaders()</h3>

<p>Call this function everytime the scope changes! It informs the FE if the current scope support custom header use. FEs should not display the custom header dialog if custom headers are not supported.</p>

<pre class="eval"> [noscript] boolean ScopeUsesCustomHeaders(in nsMsgSearchScopeValue scope,
                                           in voidPtr selection,
</pre>

<p>in boolean forFilters);</p>

<h6 id="Parameters_9" name="Parameters_9">Parameters</h6>

<dl>
 <dt><code>scope</code></dt>
 <dd> </dd>
 <dt><code>selection</code></dt>
 <dd>Could be a folder or server based on scope</dd>
 <dt><code>forFilters</code></dt>
 <dd> </dd>
</dl>

<h3 id="IsStringAttribute.28.29" name="IsStringAttribute.28.29">IsStringAttribute()</h3>

<p>Use this to determine if your attribute is a string attribute.</p>

<pre class="eval"> boolean IsStringAttribute(in nsMsgSearchAttribValue attrib);
</pre>

<h6 id="Parameters_10" name="Parameters_10">Parameters</h6>

<dl>
 <dt><code>attrib</code></dt>
 <dd> </dd>
</dl>

<h3 id="AddAllScopes.28.29" name="AddAllScopes.28.29">AddAllScopes()</h3>

<p>Add all scopes of a given type to the search.</p>

<pre class="eval"> void AddAllScopes(in nsMsgSearchScopeValue attrib);
</pre>

<h6 id="Parameters_11" name="Parameters_11">Parameters</h6>

<dl>
 <dt><code>attrib</code></dt>
 <dd> </dd>
</dl>

<h3 id="search.28.29" name="search.28.29">search()</h3>

<pre class="eval"> void search(in nsIMsgWindow aWindow);
</pre>

<h6 id="Parameters_12" name="Parameters_12">Parameters</h6>

<dl>
 <dt><code>aWindow</code></dt>
 <dd> </dd>
</dl>

<h3 id="interruptSearch.28.29" name="interruptSearch.28.29">interruptSearch()</h3>

<pre class="eval"> void interruptSearch();
</pre>

<h3 id="pauseSearch.28.29" name="pauseSearch.28.29">pauseSearch()</h3>

<p>These two methods are used when the search session is using a timer to do local search, and the search adapter needs to run a url (e.g., to reparse a local folder) and wants to pause the timer while running the url. This will fail if the current adapter is not using a timer.</p>

<pre class="eval"> void pauseSearch();
</pre>

<h3 id="resumeSearch.28.29" name="resumeSearch.28.29">resumeSearch()</h3>

<pre class="eval"> void resumeSearch();
</pre>

<h3 id="SetSearchParam.28.29" name="SetSearchParam.28.29">SetSearchParam()</h3>

<pre class="eval"> [noscript] nsMsgSearchType SetSearchParam(in nsMsgSearchType type,
                                           in voidPtr param);
</pre>

<h6 id="Parameters_13" name="Parameters_13">Parameters</h6>

<dl>
 <dt><code>type</code></dt>
 <dd> </dd>
 <dt><code>param</code></dt>
 <dd> </dd>
</dl>

<h3 id="AddResultElement.28.29" name="AddResultElement.28.29">AddResultElement()</h3>

<pre class="eval"> [noscript] void AddResultElement(in nsMsgResultElement element);
</pre>

<h6 id="Parameters_14" name="Parameters_14">Parameters</h6>

<dl>
 <dt><code>element</code></dt>
 <dd> </dd>
</dl>

<h3 id="MatchHdr.28.29" name="MatchHdr.28.29">MatchHdr()</h3>

<pre class="eval"> boolean MatchHdr(in nsIMsgDBHdr aMsgHdr,
                  in nsIMsgDatabase aDatabase);
</pre>

<h6 id="Parameters_15" name="Parameters_15">Parameters</h6>

<dl>
 <dt><code>aMsgHdr</code></dt>
 <dd> </dd>
 <dt><code>aDatabase</code></dt>
 <dd> </dd>
</dl>

<h3 id="addSearchHit.28.29" name="addSearchHit.28.29">addSearchHit()</h3>

<pre class="eval"> void addSearchHit(in nsIMsgDBHdr header,
                   in nsIMsgFolder folder);
</pre>

<h6 id="Parameters_16" name="Parameters_16">Parameters</h6>

<dl>
 <dt><code>header</code></dt>
 <dd> </dd>
 <dt><code>folder</code></dt>
 <dd> </dd>
</dl>
